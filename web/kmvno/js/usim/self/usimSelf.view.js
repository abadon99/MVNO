VALIDATE_NOT_EMPTY_MSG = {};
VALIDATE_NOT_EMPTY_MSG.usimNo01="유심카드번호 첫번째 네자리를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.usimNo02="유심카드번호 두번째 네자리를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.usimNo03="유심카드번호 세번째 네자리를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.usimNo04="유심카드번호 네번째 네자리를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.usimNo05="유심카드번호 다섯번째 세자리를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.hndsetModelNo="esim 단말 모델번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.hndsetSeq="esim 단말 일련번호를 입력해주세요. ";
VALIDATE_NOT_EMPTY_MSG.intmUniqIdntNo="esim 기기식별번호(IMEI)를 입력해주세요. ";
VALIDATE_NOT_EMPTY_MSG.eidNo="자급제 단말 EID 번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.mainImeiNo="자급제 단말 메인 IMEI 번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.digtlSimImeiNo="자급제 단말 디지털 SIM IMEI 번호를 입력해주세요. ";
VALIDATE_NOT_EMPTY_MSG.custName="이름을 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.custPhoneNo="연락 가능 전화번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.custAddr="주소를 검색해주세요.";
VALIDATE_NOT_EMPTY_MSG.custAddrDtl="주소를 검색해주세요.";
VALIDATE_NOT_EMPTY_MSG.custMail="이메일을 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.rqsshtEmlAdrsNm="이메일을 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.blpymCustNmBk="예금주명을 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.blpymMthdIdntNoBkTemp="계좌번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.npTlphNo="번호이동 할 전화번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.npPhoneSrilNum="휴대폰 일련번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.npBlpymMthdBankNo="요금납부 계좌번호를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.npBlpymMthdCardNo="요금납부 신용카드를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.answer="보안 문자를 입력해주세요.";
VALIDATE_NOT_EMPTY_MSG.tailFourTelNo="조회하실 번호를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.rssnoRegDate="주민등록증 발급일자를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.lcnsNo="운전면허증 발급번호를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.lcnsRegDate="운전면허증 발급일자를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.dsbPrsnRegDate="장애인 등록증 발급일자를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.mrtrPrsnDate="국가 유공자증 발급일자를 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.mrtrPrsnNo="국가 유공자증 발급번호를 입력해 주세요.";

VALIDATE_NUMBER_MSG = {};
VALIDATE_NUMBER_MSG.usimNo01="유심카드번호 첫번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_NUMBER_MSG.usimNo02="유심카드번호 두번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_NUMBER_MSG.usimNo03="유심카드번호 세번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_NUMBER_MSG.usimNo04="유심카드번호 네번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_NUMBER_MSG.usimNo05="유심카드번호 다섯번째 3자리를 숫자로 입력해 주세요.";
VALIDATE_NUMBER_MSG.intmUniqIdntNo="esim 기기식별번호(IMEI) 15자리 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.eidNo="자급제 단말 EID 번호에 32자리 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.mainImeiNo="자급제 단말 메인 IMEI 번호에 15자리 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.digtlSimImeiNo="자급제 단말 디지털 SIM IMEI 번호에 15자리 숫자로 입력해주세요. ";
VALIDATE_NUMBER_MSG.custPhoneNo="연락 가능 전화번호를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.npTlphNo="번호이동 할 전화번호를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.npPhoneSrilNum="휴대폰 일련번호를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.npBlpymMthdBankNo="요금납부 계좌번호를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.npBlpymMthdCardNo="요금납부 신용카드를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.answer="보안 문자를 숫자로 입력해주세요.";
VALIDATE_NUMBER_MSG.tailFourTelNo="조회하실 번호를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.rssnoRegDate="주민등록증 발급일자를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.lcnsNo="운전면허증 발급번호를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.lcnsRegDate="운전면허증 발급일자를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.dsbPrsnRegDate="장애인 등록증 발급일자를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.mrtrPrsnDate="국가 유공자증 발급일자를 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.mrtrPrsnNo="국가 유공자증 발급번호를 숫자로 입력해 주세요.";

VALIDATE_FIX_MSG = {};
VALIDATE_FIX_MSG.usimNo01="유심카드번호 첫번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.usimNo02="유심카드번호 두번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.usimNo03="유심카드번호 세번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.usimNo04="유심카드번호 네번째 4자리를 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.usimNo05="유심카드번호 다섯번째 3자리를 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.intmUniqIdntNo="esim 기기식별번호(IMEI) 15자리 숫자로 입력해주세요.";
VALIDATE_FIX_MSG.eidNo="자급제 단말 EID 번호에 32자리 숫자로 입력해주세요.";
VALIDATE_FIX_MSG.mainImeiNo="자급제 단말 메인 IMEI 번호에 15자리 숫자로 입력해주세요.";
VALIDATE_FIX_MSG.digtlSimImeiNo="자급제 단말 디지털 SIM IMEI 번호에 15자리 숫자로 입력해주세요. ";
VALIDATE_FIX_MSG.custPhoneNo="연락 가능 전화번호를 11자리이상 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.npTlphNo="번호이동 할 전화번호를 10자리이상 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.npPhoneSrilNum="휴대폰 일련번호를 4자리 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.npBlpymMthdBankNo="요금납부 계좌번호를 4자리 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.npBlpymMthdCardNo="요금납부 신용카드를 4자리 숫자로 입력해 주세요.";
VALIDATE_FIX_MSG.answer="보안 문자 6자리 숫자로 입력해주세요.";
VALIDATE_FIX_MSG.tailFourTelNo="조회하실 번호를 4자리 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.rssnoRegDate="주민등록증 발급일자를 8자리 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.lcnsRegDate="운전면허증 발급일자를 8자리 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.dsbPrsnRegDate="장애인 등록증 발급일자를 8자리 숫자로 입력해 주세요.";
VALIDATE_NOT_EMPTY_MSG.mrtrPrsnDate="국가 유공자증 발급일자를 8자리 숫자로 입력해 주세요.";

VALIDATE_COMPARE_MSG = {};
VALIDATE_COMPARE_MSG.custMail = "이메일 형식이 일치하지 않습니다.";
VALIDATE_COMPARE_MSG.rqsshtEmlAdrsNm = "이메일 형식이 일치하지 않습니다.";

var fnCustMake;
var fnOpenProc;

var controller = $.extend(new $.CommonObj(),{
	sortType : "highData"
	, focus : ""
	, usimValid : false
	, esimValid : false
	, watchValid: false
	, isOmdRegistered : false
	, custAuth : false
	, isMakeCust : false
	, payValid : false
	, isBfacAgree : false
	, isBfacAgreeRpyRetv : false
	, phoneNoData : {
		gubun : ""
		, tlphNo : ""
		, tlphNoStatChngRsnCd : ""
		, tlphNoStatCd : ""
		, encdTlphNo : ""
	}
	, searchCnt : 20
});

$(document).ready(function () {
	controller.init();

	// 주민등록증
	if( $(document).find('#datepicker-id-card01').length > 0) {
		getDatepicker('#datepicker-id-card01', 'calendar');
	}
	// 운전면허증
	if( $(document).find('#datepicker-id-card02').length > 0) {
		getDatepicker('#datepicker-id-card02', 'calendar');
	}
	// 장애인 등록증
	if( $(document).find('#datepicker-id-card03').length > 0) {
		getDatepicker('#datepicker-id-card03', 'calendar');
	}
	// 국가 유공자증
	if( $(document).find('#datepicker-id-card04').length > 0) {
		getDatepicker('#datepicker-id-card04', 'calendar');
	}

	// 셀프개통 타이틀 변경
	changeTitle();

	// 번호이동 통신사 퍼블
	// popupDataRowWrap01~ 클래스는 아래 스크립트를 위한 클래스입니다.
	// 추가 통신사 아코디언이 필요할 시 popupDataRowWrap03와 같이
	// 새로운 클래스를 추가 또는 아이디로 사용 가능합니다.
	accordionControl(
		'.popupDataRowWrap01 .folderBtn',
		'.popupDataRowWrap01 .folderContent',
		'.popupDataRowWrap01',
		'통신사 열기',
		'통신사 닫기'
	);
	accordionControl(
		'.popupDataRowWrap02 .folderBtn',
		'.popupDataRowWrap02 .folderContent',
		'.popupDataRowWrap02',
		'통신사 열기',
		'통신사 닫기'
	);
	accordionControl(
		'.popupDataRowWrap03 .folderBtn',
		'.popupDataRowWrap03 .folderContent',
		'.popupDataRowWrap03',
		'통신사 열기',
		'통신사 닫기'
	);

	/** @페이징_요금제 */
	controller.fnPagingEvent(callPplSelPop, 'listPageBtn');

	/** @유심_선택 */
	$(":radio[name='simType']").on("click", function() {
		var simVal = $(this).val();
		if("sim" == simVal) {
			$(".simArea").show();
			$("#prodTypeCd").val("U");
			hideEsimArea();
		} else {
			$(".simArea").hide();
			$("#prodTypeCd").val("E");
			showEsimArea();
			//togglePopup('simType-2', 'eSIMAboutPopupView');
			$("#eidNo, #mainImeiNo, #digtlSimImeiNo").val("");
		}
	});

	// 디폴트 유심(USIM)선택
	$(":radio[name='simType'][value='sim']").trigger("click");

	/** @가입유형_선택_설명노출 */
	$(":radio[name='oderTypeCd']").on("click", function() {
		var _thisVal = $(this).val();

		if("01" == _thisVal) {
			$("#joinTypeTxt").text("새로운 번호로 개통합니다.");
		} else {
			$("#joinTypeTxt").text("기존 번호로 개통합니다.(이후 통신사 인증 필수).");
		}

		if(false == $("#joinTypeTxtArea").is(":visible")) {
			$("#joinTypeTxtArea").show();
		}
	});

	/** @유심카드번호_유효성체크 */
	$("#usimValidChk").on("click", function() {
		if("" == $("#saleCmpnId").val()) {
			alert("알뜰폰 사업자를 선택해 주세요.");
			$("#bizSelBtn").focus();
			return;
		}
		if("" == $("#pplId").val()) {
			alert("요금제를 선택해 주세요.");
			$("#pplSelBtn").focus();
			return;
		}
		if(1 > $(":radio[name='oderTypeCd']:checked").length) {
			alert("가입유형을 선택해 주세요.");
			$(":radio[name='oderTypeCd']:eq(0)").focus();
			return;
		}

		// 유효성 체크
		validator.config={};
		validator.config['usimNo01'] = 'isNonEmpty';
		validator.config['usimNo02'] = 'isNonEmpty';
		validator.config['usimNo03'] = 'isNonEmpty';
		validator.config['usimNo04'] = 'isNonEmpty';
		validator.config['usimNo05'] = 'isNonEmpty';

		if (validator.validate()) {
			controller.usimValid = false;

			var iccId = new Array();
			iccId.push($("#usimNo01").val());
			iccId.push($("#usimNo02").val());
			iccId.push($("#usimNo03").val());
			iccId.push($("#usimNo04").val());
			iccId.push($("#usimNo05").val());

			var varData = controller.getSerializedData({
				iccId : iccId.join("")
				, saleCmpnId : $("#saleCmpnId").val()
			});

			controller.ajaxSend({
				cache:false
				,url:svcRouteURL + "/fe/service/usim/getUsimUsePossYn.json"
				,data:varData
				,dataType:"json"
				,isBlock:true
				,successCall:function(result){
					var usimPossYn = result.usimPossYn;
					if("Y" == usimPossYn) {
						$("#commonAlertPopupTitle").text("유심카드 유효성 체크");
						$("#commonAlertPopupContent").text("사용이 가능한 유심입니다.");
						togglePopup('commonAlertPopupBtn', 'commonAlertPopup')

						controller.usimValid = true;
						// 유효성 체크 버튼 dim 처리
						$("#usimValidChk").addClass("btnDim");
						// 유효성 체크 버튼 disabled 처리
						$("#usimValidChk").prop("disabled", true);
						// 유심 번호 수정 불가 처리
						$("input[id^='usimNo0']").prop("disabled", true);
						// 개통 심(SIM) 유형 선택 불가 처리
						$(":radio[name='simType']").prop("disabled", true);
					}
				}
			});
		} else {
			alert(validator.getErrorMsg());
		}
	});

	/** @eSIM 개통여부 조회 */
	$("#esimValidChk").on("click", function() {

		if("" == $("#saleCmpnId").val()) {
			alert("알뜰폰 사업자를 선택해 주세요.");
			$("#bizSelBtn").focus();
			return;
		}

		// 유효성 체크
		validator.config={};
		validator.config['eidNo'] = 'isNumFix32';
		validator.config['mainImeiNo'] = 'isNumFix15';
		validator.config['digtlSimImeiNo'] = 'isNumFix15';

		if (validator.validate()) {
			controller.esimValid = false;

			var varData = controller.getSerializedData({
				eidNo : $("#eidNo").val()
				, mainImeiNo : $("#mainImeiNo").val()
				, digtlSimImeiNo : $("#digtlSimImeiNo").val()
				, saleCmpnId : $("#saleCmpnId").val()
			});

			controller.ajaxSend({
				cache:false
				,url:svcRouteURL + "/fe/service/usim/getEsimPhoneUsePossYn.json"
				,data:varData
				,dataType:"json"
				,isBlock:true
				,successCall:function(result){
					console.log(result);
					var usimSelfResBean = result.usimSelfResBean;
					var esimOpnPosblYn = usimSelfResBean ? usimSelfResBean.esimOpnPosblYn : "";

					if(esimOpnPosblYn == "Y"){ // eSIM 개통 가능
						controller.esimValid = true;

						$("#esimValidChk, #imgRegForOmdHndset, #imgRegForOmdHndset3").attr("disabled", "disabled");
						$("#eidNo, #mainImeiNo, #digtlSimImeiNo").attr("disabled", "disabled");
						$(":radio[name='simType']").prop("disabled", true);
						$('#esimOpenGuide').hide();
						$('#esimValidGuide').show();

						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "eSIM 셀프개통이 가능합니다. <br>다음 화면으로 이동해주세요.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "NIO") { // 기기원부 데이터가 없음

						$("#intmMdlId").val(usimSelfResBean.intmMdlId);
						$("#intmMdlNm").val(usimSelfResBean.intmMdlNm);

						$("#omdRegNeedModelPopupTitle").text("eSIM 개통 가능 여부 결과");
						$("#omdHndsetNeedRegMsg").show();
						showOmdRegisterPopup();
					}else if(esimOpnPosblYn == "IU"){ // 현재 IMEI2가 사용중
						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "현재 IMEI2가 사용중입니다.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "ENM"){ // 입력한 EID와 기기원부 조회에서 EID와 다름
						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "휴대폰 정보가 올바른지 다시 확인하시기 바랍니다.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "ENS"){ // eSIM 지원 단말이 아님
						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "eSIM 지원 단말이 아닙니다. <br>유심(USIM)으로 셀프개통 진행해주세요.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "NSEI"){ // 패드 포함 기타 기기 개통불가 안내 //이거 추가
						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "휴대폰, 스마트워치를 제외한 스마트기기(태블릿 등)는 eSIM 개통을 지원하지 않습니다.", "commonAlertPopupBtn");
					}
					else{
						showCommonAlertPopup("eSIM 개통 가능 여부 결과", "eSIM 셀프개통이 불가능합니다.<br>고객센터에 문의해주세요.", "commonAlertPopupBtn");
					}
				}
			});
		}else{
			alert(validator.getErrorMsg());
		}
	});

	/** @watch 개통여부 조회 */
	$("#watchValidChk").on("click", function() {

		if(!$("#saleCmpnId").val()) {
			alert("알뜰폰 사업자를 선택해 주세요.");
			$("#bizSelBtn").focus();
			return;
		}

		// 유효성 체크
		validator.config={};
		validator.config['eidNo'] = 'isNumFix32';
		validator.config['digtlSimImeiNo'] = 'isNumFix15';

		if (validator.validate()) {
			controller.esimValid = false;

			var varData = controller.getSerializedData({
				eidNo : $("#eidNo").val()
				, digtlSimImeiNo : $("#digtlSimImeiNo").val()
				, saleCmpnId : $("#saleCmpnId").val()
			});

			controller.ajaxSend({
				cache:false
				,url:svcRouteURL + "/fe/service/usim/getEsimWatchUsePossYn.json"
				,data:varData
				,dataType:"json"
				,isBlock:true
				,successCall:function(result){
					console.log(result);
					var usimSelfResBean = result.usimSelfResBean;
					var esimOpnPosblYn = usimSelfResBean ? usimSelfResBean.esimOpnPosblYn : "";

					if(esimOpnPosblYn == "Y"){ // eSIM 개통 가능
						controller.watchValid = true;

						$("#watchValidChk").attr("disabled", "disabled");
						$("#eidNo, #digtlSimImeiNo").attr("disabled", "disabled");
						$('#watchOpenGuide').hide();
						$('#watchValidResult').show();

						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "eSIM 셀프개통이 가능합니다. <br>다음 화면으로 이동해주세요.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "NIO") { // 기기원부 데이터가 없음

						$("#intmMdlId").val(usimSelfResBean.intmMdlId);
						$("#intmMdlNm").val(usimSelfResBean.intmMdlNm);

						$("#omdRegNeedModelPopupTitle").text("워치 개통(eSIM) 가능 여부 결과");
						$("#omdHndsetNeedRegMsg").hide();
						showOmdRegisterPopup();
					}else if(esimOpnPosblYn == "IU"){ // 현재 IMEI2가 사용중
						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "현재 IMEI2가 사용중입니다.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "ENM"){ // 입력한 EID와 기기원부 조회에서 EID와 다름
						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "휴대폰 정보가 올바른지 다시 확인하시기 바랍니다.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "ENS"){ // eSIM 지원 단말이 아님
						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "eSIM 지원 단말이 아닙니다. <br>유심(USIM)으로 셀프개통 진행해주세요.", "commonAlertPopupBtn");
					}else if(esimOpnPosblYn == "NSEI"){ // 패드 포함 기타 기기 개통불가 안내 //이거 추가
						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "휴대폰, 스마트워치를 제외한 스마트기기(태블릿 등)는 eSIM 개통을 지원하지 않습니다.", "commonAlertPopupBtn");
					}
					else{
						showCommonAlertPopup("워치 개통(eSIM) 가능 여부 결과", "eSIM 셀프개통이 불가능합니다.<br>고객센터에 문의해주세요.", "commonAlertPopupBtn");
					}
				}
			});
		}else{
			alert(validator.getErrorMsg());
		}
	});

	/** @watch 개통 모회선 가능여부 조회 */
	$("#watchSelfOpen").on("click", function() {

		if(controller.watchValid == false){
			alert("워치(eSIM) 개통 가능여부 체크를 해주세요.");
			return;
		}

		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/getEsimWatchMotliUsePossYn.json"
			,dataType:"json"
			,isBlock:true
			,successCall:function(result){
				console.log(result);
				var usimSelfResBean = result.usimSelfResBean;

				if(usimSelfResBean.motliPossYn == "Y"){
					location.href="/fe/service/usim/watchSelfReqView.do";
				}
			}
		});
	});

	/** @모델목록 조회 */
	$("#modelSearch").on("click", function(){
		$("#modelSearchPageNo").val("1");
		searchModelList();
	});

	/** @세대구분 선택 */
	$("#generationDropList button").on("click", function(){
		var code = $(this).attr("code");
		$("#netDivCd").val(code);
	});

	/** @eSIM OMD 단말 등록 */
	$("#omdHndsetAdd, #omdHndsetAddInPopup").on("click", function(){
		if($(this).attr("id") == "omdHndsetAddInPopup") {
			if("" == $("#intmMdlId").val() || "" == $("#intmMdlNm").val()) {
				alert("공통 모델을 선택해 주세요.");
				return;
			}

			togglePopup('omdHndsetAdd', 'omdHndsetRegResultPopupView03');
		}

		registerOmdHndset();
	});

	/** @워치 OMD 등록*/
	$("#watchOmdHndsetReg").on("click", function(){

		registerWatchOmdHndset();
	});

	/** @eSIM 입력 값 자리수 체크 및 버튼 활성화/비활성화 */
	$("#eidNo, #mainImeiNo, #digtlSimImeiNo").on("input", function(e){
		if($('#prodTypeCd').val() == 'E'){

			if($("#eidNo").attr("size") == $("#eidNo").val().length
				&& $("#mainImeiNo").attr("size") == $("#mainImeiNo").val().length
				&& $("#digtlSimImeiNo").attr("size") == $("#digtlSimImeiNo").val().length){ // esim 정보 데이터 자리수 체크

				$("#esimValidChk, #omdHndsetAdd").removeAttr('disabled');
			}else{ // // esim 정보 데이터 자리수 맞지 않음

				$("#esimValidChk, #omdHndsetAdd").attr("disabled", "disabled");
			}

		}else if($('#prodTypeCd').val() == 'W'){
			if($("#eidNo").attr("size") == $("#eidNo").val().length
				&& $("#digtlSimImeiNo").attr("size") == $("#digtlSimImeiNo").val().length){ // esim 정보 데이터 자리수 체크

				$("#watchValidChk").removeAttr('disabled');
			}else{ // // 워치 정보 데이터 자리수 맞지 않음

				$("#watchValidChk").attr("disabled", "disabled");
			}
		}
	});

	/** @모델명 자동 대문자로 변경 */
	$("#modelNm").on("input", function(e){
		$(this).val($(this).val().toUpperCase());
	});

	/** @eSIM 이미지 업로드 버튼 클릭 */
	$("#imgRegForOmdHndset, #imgRegForOmdHndset3").on("click", function(e){

		if($(this).attr("id") == "imgRegForOmdHndset3") {
			togglePopup("EIDIMEIConfirmToIMGPopupBtn", "EIDIMEIConfirmToIMGPopupView");
		}

		$("#omdHndsetImageUpload").val("");

		e.preventDefault();
		$("#omdHndsetImageUpload").click();
	});

	/** @eSIM 이미지 선택됨 */
	$("#omdHndsetImageUpload").on("change", function(){
		if (!validation(this.files[0])) {
			return;
		}

		fnFinishOmdHndsetImageUpload();
	})

	/** @신분증확인_종류선택 */
	$(":radio[name='idCardType']").on("click", function() {
		var _thisId = $(this).attr("id");
		$("div[class^='idCardType']").hide();
		$("div."+_thisId).show();
	});
	// 디폴트 첫번째 신분증 선택
	$(":radio[name='idCardType']:eq(0)").trigger("click");

	/** @신분증확인_면허번호_지역 */
	$(":button[name='lcnsAreaBtn']").on("click", function() {
		var lcnsRgnCd = $(this).attr("value");
		$("#lcnsRgnCd").val(lcnsRgnCd);
	});

	/** @명세서_선택 */
	$(":radio[name='rqsshtPprfrmCd']").on("click", function() {
		var rqsshtPprfrmCd = $(this).val();
		if("CB" == rqsshtPprfrmCd) {
			$("#rqsshtPprfrmArea01").show();
			$("#rqsshtPprfrmArea02").hide();
		} else {
			$("#rqsshtPprfrmArea02").show();
			$("#rqsshtPprfrmArea01").hide();
		}
	});
	// 디폴트 이메일 선택
	$(":radio[name='rqsshtPprfrmCd']:eq(0)").trigger("click");

	/** @납부방법_선택 */
	$(":radio[name='blpymMthdCd']").on("click", function() {
		var blpymMthdCd = $(this).val();
		if("D" == blpymMthdCd) {
			$("#blpymMthdCdArea01").show();
			$("#blpymMthdCdArea02").hide();
		} else {
			$("#blpymMthdCdArea02").show();
			$("#blpymMthdCdArea01").hide();
		}
	});
	// 디폴트 자동이체 선택
	$(":radio[name='blpymMthdCd']:eq(0)").trigger("click");

	/** @납부방법_은행명_선택 */
	$(":button[name='bankBtn']").on("click", function() {
		var bankCd = $(this).attr("value");
		$("#bankCd").val(bankCd);
		if("003" == bankCd) {
			togglePopup('btnPopupIndustrialBank', 'popupIndustrialBank');
			$(".ibkinfoshow").show();
		}
		if("003" !== bankCd) {
			$(".ibkinfoshow").hide();
		}
	});

	/** @납부방법_카드명_선택 */
	$(":button[name='cardBtn']").on("click", function() {
		var cardCd = $(this).attr("value");
		$("#cardCd").val(cardCd);
	});

	/** @납부방법_유효기간_월_선택 */
	$(":button[name='cardMonthBtn']").on("click", function() {
		var cardMonth = $(this).attr("value");
		$("#cardEffectMonth").val(cardMonth);
	});
	$(":button[name='cardMonthBtn']:eq(0)").trigger("click");

	/** @납부방법_유효기간_년_선택 */
	$(":button[name='cardYearBtn']").on("click", function() {
		var yearVal = $(this).attr("value");
		$("#cardEffectYear").val(yearVal);
	});

	/** @번호이동_인증유형_선택 */
	$(":radio[name='npAthnCdRadio']").on("click", function() {
		var npAthnVal = $(this).val();
		// 인증유형 이미지 영역 전체 숨기기
		$("div[class^='imgPassType']").hide();

		// 각 영역별 노출 처리
		if("2" == npAthnVal) {
			$("div.imgPassType01").show();
		} else if("3" == npAthnVal) {
			$("div.imgPassType02").show();
		} else if("5" == npAthnVal) {
			$("div.imgPassType03").show();
		} else if("1" == npAthnVal) {
			$("div.imgPassType04").show();
		}

		// 값 세팅
		$("#npAthnCd").val(npAthnVal);
	});
	// 번호이동 프로세스 개선
	$(":radio[name='selfTelecom']").on("click", function() {
		var selfTelecomVal = $(this).val();
		$("div[class^='selfTelecom']").hide();

		// 각 영역별 노출 처리
		if("1" == selfTelecomVal) {
			$("div.selfTelecom01").show();
		} else if("2" == selfTelecomVal) {
			$("div.selfTelecom02").show();
		} else if("3" == selfTelecomVal) {
			$("div.selfTelecom03").show();
		} else if("4" == selfTelecomVal) {
			$("div.selfTelecom04").show();
		}
	});
	// 디폴트 인증유형 선택
	$(":radio[name='npAthnCdRadio']:eq(0)").trigger("click");

	// 공통약관 전체 선택
	$(document).on("click", ":checkbox[id='allStpltChk']", function() {
		if($(this).is(":checked")) {
			$(":checkbox[id^='stpltChk']").prop("checked", true);
		} else {
			$(":checkbox[id^='stpltChk']").prop("checked", false);
		}
	});

	// 공통약관 선택에 따른 전체 선택 처리
	$(document).on("click", ":checkbox[id^='stpltChk']", function() {
		var isChk = true;

		var stpltLen = $(":checkbox[id^='stpltChk']").length;
		for(var i=0; i<stpltLen; i++) {
			if(false == $(":checkbox[id^='stpltChk']").eq(i).is(":checked")) {
				isChk = false;
			}
		}

		if(isChk) {
			$(":checkbox[id='allStpltChk']").prop("checked", true);
		} else {
			$(":checkbox[id='allStpltChk']").prop("checked", false);
		}
	});

	// 유심카드번호 각 최대 갯수 채워지면 다음칸 이동 처리
	$("input[id^='usimNo']").on("keyup", function() {
		var _thisId = $(this).attr("id");
		if("usimNo05" != _thisId && $(this).val().length == 4) {
			$(this).parent("div").next().find("input").focus();
		}
	});

	// 시간에 따른 가입유형 가능여부 체크
	fnSbscTypeCdPoss();

	// 파라미터로 넘어온 사업자코드가 있을 시 강제세팅
	if($("#reqSaleCmpnId").val()) {
		saleCmnpnAutoChk();
	}
	// 파라미터로 넘어온 요금제코드가 있을 시 강제세팅
	if("" != $("#reqPplId").val()) {
		pplInfoAutoChk();
	}

	var htmlString = "<span class='message'>현재 단계</span>";
	$("div.applySteps > ul > li:eq(0)").prepend(htmlString);


	$(document).on("click", "#pass,#card", function() {
		var idVal = $(this).attr("id");
		$("#pass").removeClass("active");
		$("#card").removeClass("active");
		$(this).addClass("active");
		$("#btnCertPopup").attr("authType",idVal);  //인증타입
		if(idVal == "pass"){ //일단 패스는 기존대로 팝업창으로 //$("#authType").val("1"); 이것도 나중에 손보자
			$("#authType").val("1");
			$("#certCardGuideTxtArea").hide(); //카드 본인인증 확인 관련
			$("#certCustPhoneNoArea").show(); //연락처
			$("#certCustPhoneAgency,#certPassAgreementArea").show(); //통신사 보이도록
			$("#btnCertPopup").attr("onclick","fnGetPassCertReq('10');");  // 버튼 함수 설정
			chkCustPassInputDataSufyYn(); // 고객 입력 데이터가 충족 하였는지
		}
		if(idVal == "card"){ //임시로 카드만
			$("#authType").val("2");
			$("#certCardGuideTxtArea").show(); //카드 본인인증 확인 관련
			$("#certCustPhoneNoArea").show(); //연락처
			$("#certCustPhoneAgency,#certPassAgreementArea").hide(); //통신사 안보이도록
			$("#btnCertPopup").attr("onclick","fnGetCardCertPopup('10');");
			chkCustCardInputDataSufyYn(); // 고객 입력 데이터가 충족 하였는지
		}
	});

	$(".ibkinfoshow").hide();

	/** @주소조회_팝업호출 */
	$(document).on("click", "#btnCustAddr", function(e) {
		window.open("/fe/service/common/JusoController.do","pop","width=570,height=650, scrollbars=yes, resizable=yes");
	});


	/** @eSIM 셀프개통 안내사항 팝업 */
	$(document).on("click", "#eSimSelfOpenGuideConfirm", function(e) {
		setTimeout(function() {
			togglePopup('eSIMAboutPopupView', 'eSIMAboutPopupView');
		}, 200);
	});

	/** @eSIM EID, IMEI 확인 및 이미지 등록 방법을 확인해주세요 팝업*/
	$(document).on("click", "#EIDIMEIConfirmToIMGPopupBtn", function(e) {
		setTimeout(function() {
			togglePopup('EIDIMEIConfirmToIMGPopupView', 'EIDIMEIConfirmToIMGPopupView');
		}, 200);
	});

	/** 셀프개통 요금제 직링크 진입시 요금제가 유효하지 않은경우 안내 팝업 노출 */
	if("N" == $('#selfBizrMappPplYn').val()){
		togglePopup('pplSelBtn', 'popupAutoPplChkFail');
	}
});

// 정렬
$(document).on("click", "#pplSortBtnUl > li > button", function() {
	var sortType = $(this).attr('sortType');

	controller.sortType = sortType;
	controller.focus = 'sort'

	callPplSelPop(1);
});

/** 팝업 메세지 출력 */
function showCommonAlertPopup(title, content, focusButtionId){
	$("#commonAlertPopupTitle").html(title);
	$("#commonAlertPopupContent").html(content);
	togglePopup(focusButtionId, 'commonAlertPopup');
}

/* 첨부파일 검증 */
function validation(obj){
    const fileTypes = ['application/pdf', 'image/gif', 'image/jpeg', 'image/png', 'image/bmp', 'image/tif', 'application/haansofthwp', 'application/x-hwp'];
    if (obj.name.length > 100) {
        alert("파일명이 100자 이상인 파일은 제외되었습니다.");
        return false;
    } else if (obj.size > (10 * 1024 * 1024)) {
        alert("최대 파일 용량인 10MB를 초과한 파일은 제외되었습니다.");
        return false;
    } else if (obj.name.lastIndexOf('.') == -1) {
        alert("확장자가 없는 파일은 제외되었습니다.");
        return false;
    } else if (!fileTypes.includes(obj.type)) {
        alert("첨부가 불가능한 파일은 제외되었습니다.");
        return false;
    } else {
        return true;
    }
}

/** 자급제 단말 이미지 업로드 */
function fnFinishOmdHndsetImageUpload(){
	var form = $("#omdHndsetImageForm");
	var formData = new FormData(form[0]);

	controller.ajaxSend({
		type: "POST"
		,url: svcRouteURL + "/fe/service/usim/omdHndsetImageUpload.json"
		,data: formData
		,isBlock: true
		,contentType: false //this is requireded please see answers above
		,processData: false //this is requireded please see answers above
		,successCall:function(result){
			var usimSelfResBean = result.usimSelfResBean;

			if(usimSelfResBean){
				$('#eidNo').val(usimSelfResBean.eidNo);
				$('#mainImeiNo').val(usimSelfResBean.mainImeiNo);
				$('#digtlSimImeiNo').val(usimSelfResBean.digtlSimImeiNo).trigger("input");
			}
		}
	});
}

/** @eSIM OMD 단말 등록 */
function registerOmdHndset(){

	if("" == $("#saleCmpnId").val()) {
		alert("알뜰폰 사업자를 선택해 주세요.");
		$("#bizSelBtn").focus();
		return;
	}

	// 유효성 체크
	validator.config={};
	validator.config["eidNo"] = "isNumFix32";
	validator.config["mainImeiNo"] = "isNumFix15";
	validator.config["digtlSimImeiNo"] = "isNumFix15";

	if (validator.validate()) {
		var varData = controller.getSerializedData({
			saleCmpnId : $("#saleCmpnId").val()
			, intmMdlId : $("#intmMdlId").val()
			, intmMdlNm : $("#intmMdlNm").val()
			, eidNo : $("#eidNo").val()
			, mainImeiNo : $("#mainImeiNo").val()
			, digtlSimImeiNo : $("#digtlSimImeiNo").val()
		});

		controller.isOmdRegistered = false;
		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/esimPhoneOmdHndsetReg.json"
			,data:varData
			,dataType:"json"
			,isBlock:true
			,successCall:function(result){
				console.log(result);
				var usimSelfResBean = result.usimSelfResBean;
				var omdHndsetRegYn = usimSelfResBean.omdHndsetRegYn;

				if("Y" == omdHndsetRegYn) {
					controller.isOmdRegistered = true;

					if($("#esimValidChk").length > 0){ // 유심/eSIM 설프개통
						togglePopup('btnID', 'omdHndsetRegResultPopupView');
					}else{ // 자급제 단말 등록
						togglePopup('btnID', 'omdHndsetRegResultPopupView02');
					}
				}else if("N" == omdHndsetRegYn){
					$("#intmMdlId").val(usimSelfResBean.intmMdlId);
					$("#intmMdlNm").val(usimSelfResBean.intmMdlNm);

					$("#omdRegNeedModelPopupTitle").text("자급제 단말 등록 결과");
					$("#omdHndsetNeedRegMsg").hide();
					showOmdRegisterPopup();
				}
			}
		});
	}else{
		//showCommonAlertPopup("개통 심(SIM) 유형", validator.getErrorMsg());
		alert(validator.getErrorMsg());
	}
}

/** @워치 OMD 단말 등록 */
function registerWatchOmdHndset(){

	if("" == $("#saleCmpnId").val()) {
		alert("알뜰폰 사업자를 선택해 주세요.");
		$("#bizSelBtn").focus();
		return;
	}

	if("" == $("#intmMdlId").val() || "" == $("#intmMdlNm").val()) {
		alert("모델을 선택해 주세요.");
		$("#modelSearch").focus();
		return;
	}

	// 유효성 체크
	validator.config={};
	validator.config["eidNo"] = "isNumFix32";
	validator.config["digtlSimImeiNo"] = "isNumFix15";

	if (validator.validate()) {
		var varData = controller.getSerializedData({
			saleCmpnId : $("#saleCmpnId").val()
			, intmMdlId : $("#intmMdlId").val()
			, intmMdlNm : $("#intmMdlNm").val()
			, eidNo : $("#eidNo").val()
			, digtlSimImeiNo : $("#digtlSimImeiNo").val()
		});

		controller.isOmdRegistered = false;
		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/esimWatchOmdHndsetReg.json"
			,data:varData
			,dataType:"json"
			,isBlock:true
			,successCall:function(result){
				console.log(result);
				var usimSelfResBean = result.usimSelfResBean;
				var omdHndsetRegYn = result.usimSelfResBean.omdHndsetRegYn;

				if("Y" == omdHndsetRegYn) {
					controller.isOmdRegistered = true;
					togglePopup('btnID', 'omdHndsetRegResultPopupView');
				}else if("N" == omdHndsetRegYn){
					$("#intmMdlId").val(usimSelfResBean.intmMdlId);
					$("#intmMdlNm").val(usimSelfResBean.intmMdlNm);

					$("#omdRegNeedModelPopupTitle").text("자급제 단말 등록 결과");
					$("#omdHndsetNeedRegMsg").hide();
					showOmdRegisterPopup();
				}
			}
		});
	}else{
		//showCommonAlertPopup("개통 심(SIM) 유형", validator.getErrorMsg());
		alert(validator.getErrorMsg());
	}
}

/** @자급제 등록 팝업 표시 */
function showOmdRegisterPopup(){
	if($("#intmMdlId").val() == "" || $("#intmMdlNm").val() == ""){
		$("#omdGenerationArea").show();
		selectModel();
	}else{
		$("#omdGenerationArea").hide();
	}

	togglePopup('omdHndsetAddInPopup', 'omdHndsetRegResultPopupView03');
}

/** @이전페이지_이동 */
function goPrevPage() {
	var dispView = $("div.formContainer:visible").attr("dispView");
	if("view01" == dispView) {
		location.href = "/fe/service/usim/usimSelfMain.do";

	} else if("view02" == dispView) {
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 1번째 영역 표시
		$("div.formContainer[dispView='view01']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(0)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(0)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(0)").attr("aria-current", "step");

	} else if("view03" == dispView) {
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 2번째 영역 표시
		$("div.formContainer[dispView='view02']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(1)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(1)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(1)").attr("aria-current", "step");
	} else if("newSelf01" == dispView || "phoneMove01" == dispView) {
		// 팝업 호출
		togglePopup('prevPage', 'selfOpenPrevGoMain');
	} else if("phoneMove02" == dispView) {
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 번호이동 1번째 영역 표시
		$("div.formContainer[dispView='phoneMove01']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(3)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(3)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(3)").attr("aria-current", "step");
		// 숨겨놨던 다음 버튼 노출
		$("#nextStepBtnArea").show();
	} else if("view04" == dispView) {
		var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//oderTypeCdCheck(oderTypeCd);

		if("01" == oderTypeCd) {
			// 전체 영역 숨김처리
			$("div.formContainer").hide();
			// 번호이동 1번째 영역 표시
			$("div.formContainer[dispView='newSelf01']").show();
			// 스텝 이동
			$("div.applySteps > ul > li").removeClass("current");
			$("div.applySteps > ul > li:eq(3)").addClass("current");
			// 셀프개통 타이틀 변경
			changeTitle();
			// 현재 단계 이동
			var htmlString = "<span class='message'>현재 단계</span>";
			$("div.applySteps > ul > li > span").remove();
			$("div.applySteps > ul > li:eq(3)").prepend(htmlString);
			$("div.applySteps > ul > li").attr("aria-current", null);
			$("div.applySteps > ul > li:eq(3)").attr("aria-current", "step");
		} else if("02" == oderTypeCd) {
			// 전체 영역 숨김처리
			$("div.formContainer").hide();
			// 번호이동 1번째 영역 표시
			$("div.formContainer[dispView='phoneMove02']").show();
			// 스텝 이동
			$("div.applySteps > ul > li").removeClass("current");
			$("div.applySteps > ul > li:eq(3)").addClass("current");
			// 셀프개통 타이틀 변경
			changeTitle();
			// 현재 단계 이동
			var htmlString = "<span class='message'>현재 단계</span>";
			$("div.applySteps > ul > li > span").remove();
			$("div.applySteps > ul > li:eq(3)").prepend(htmlString);
			$("div.applySteps > ul > li").attr("aria-current", null);
			$("div.applySteps > ul > li:eq(3)").attr("aria-current", "step");
		}
	}
}

/** @다음페이지_이동 */
function goNextStep(input) {
	// 다음 버튼 다음으로 설정
	$("#nextStepTxt").text("다음");
	$("#goNextStep").attr("dynamicParamAttr1", "다음");
	// 다음버튼 영역 노출
	$("#nextStepBtnArea").show();

	var dispView = $("div.formContainer:visible").attr("dispView");
	if("view01" == dispView) {
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView, param);
		if("" == $("#saleCmpnId").val()) {
			alert("알뜰폰 사업자를 선택해 주세요.");
			$("#bizSelBtn").focus();
			return;
		}
		if("" == $("#pplId").val()) {
			alert("요금제를 선택해 주세요.");
			$("#pplSelBtn").focus();
			return;
		}

		var sbscTypeCd = $(":radio[name='pplListChk']:checked").attr("sbscTypeCd");

		/** 요금제 가입유형에 따른 활성화 처리 */
		// 전체 활성화 처리
		$(":radio[name='oderTypeCd']").prop("disabled", false);
		// 신규가입 불가능
		if(sbscTypeCd.indexOf("01") < 0) {
			$(":radio[id='oderTypeCd01']").prop("disabled", true);
			if($(":radio[id='oderTypeCd01']").prop("checked")){
				$(":radio[id='oderTypeCd01']").prop("checked", false);
				alert("선택하신 요금제는 신규가입 불가능 상품 입니다. 다시 선택해주세요.");
				return;
			}
		}
		// 번호이동 불가능
		if(sbscTypeCd.indexOf("02") < 0) {
			$(":radio[id='oderTypeCd02']").prop("disabled", true);
			if($(":radio[id='oderTypeCd02']").prop("checked")){
				$(":radio[id='oderTypeCd02']").prop("checked", false);
				alert("선택하신 요금제는 번호이동 불가능 상품 입니다. 다시 선택해주세요.");
				return;
			}
		}

		if(1 > $(":radio[name='oderTypeCd']:checked").length) {
			alert("가입유형을 선택해 주세요.");
			$(":radio[name='oderTypeCd']:eq(0)").focus();
			return;
		}

		if($("#prodTypeCd").val() == "U"){
			validator.config={};
			validator.config['usimNo01'] = 'isNonEmpty';
			validator.config['usimNo02'] = 'isNonEmpty';
			validator.config['usimNo03'] = 'isNonEmpty';
			validator.config['usimNo04'] = 'isNonEmpty';
			validator.config['usimNo05'] = 'isNonEmpty';
			if (!validator.validate()) {
				alert(validator.getErrorMsg());
				return;
			}
			if(false == controller.usimValid) {
				alert("유심카드번호 유효성 체크를 해주세요.");
				return;
			}
		}else if($("#prodTypeCd").val() == "E"){

			validator.config={};
			validator.config['eidNo'] = 'isNumFix32';
			validator.config['mainImeiNo'] = 'isNumFix15';
			validator.config['digtlSimImeiNo'] = 'isNumFix15';

			if (!validator.validate()) {
				alert(validator.getErrorMsg());
				return;
			}

			if(false == controller.esimValid) {
				alert("eSIM 개통 가능여부 체크를 해주세요.");
				return;
			}
		}else if($("#prodTypeCd").val() == "W"){
			// Nothing
		}

		var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//oderTypeCdCheck(oderTypeCd);

		var varData = controller.getSerializedData({
			saleCmpnId : $("#saleCmpnId").val()
			, oderTypeCd : oderTypeCd
		});

		//가입가능 조건 체크.
		var chkSbscPosblCondYnFlag = fnChkSbscPosblCondYn(oderTypeCd); //안에 ajax 비동기 처리하겠다...
		if(!chkSbscPosblCondYnFlag){
			$(":radio[name='oderTypeCd']").prop("disabled", false);
			if(oderTypeCd == "01"){
				$(":radio[id='oderTypeCd01']").prop("disabled", true);
				if($(":radio[id='oderTypeCd01']").prop("checked")){
					$(":radio[id='oderTypeCd01']").prop("checked", false);
					alert("선택하신 요금제는 신규가입 불가능 상품 입니다. 다시 선택해주세요.");
				}
			}
			if(oderTypeCd == "02"){
				$(":radio[id='oderTypeCd02']").prop("disabled", true);
				if($(":radio[id='oderTypeCd02']").prop("checked")){
					$(":radio[id='oderTypeCd02']").prop("checked", false);
					alert("선택하신 요금제는 번호이동 불가능 상품 입니다. 다시 선택해주세요.");
				}
			}
			$("#goNextStep").focus();
			return;
		}

		// 약관동의 호출
		controller.ajaxSendDone({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/listSelfStpltInfo.thym"
			,data:varData
			,isBlock:true
			,replaceAttr:".selfOrdrStpltArea"
			,successCall:function(result){
				setTimeout(function() {
					// 약관
					var commonStpltLen = $(":checkbox[id^='stpltChk']").length;
					for(var i=0; i<commonStpltLen; i++) {
					    accordionControl(
					    	      '.agreementAccordion'+$(":checkbox[id^='stpltChk']").eq(i).val()+' .btnOpenAgree',
					    	      '.agreementAccordion'+$(":checkbox[id^='stpltChk']").eq(i).val()+' .fieldData',
					    	      '.agreementAccordion'+$(":checkbox[id^='stpltChk']").eq(i).val(),
					    	      $(":checkbox[id^='stpltChk']").eq(i).attr("stpltNm")+' 열기',
					    	      $(":checkbox[id^='stpltChk']").eq(i).attr("stpltNm")+' 닫기'
					    	    );
					}
				}, 200);
			}
		});

		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 2번째 영역 표시
		$("div.formContainer[dispView='view02']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(1)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(1)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(1)").attr("aria-current", "step");
	} else if("view02" == dispView) {
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView, param);

		if(false == controller.custAuth) {
			alert("본인인증을 하시기 바랍니다.");
			if(!$("#btnCertPopup").attr("disalbed")){
				$("#btnCertPopup").focus();
			}else{
				$("#pass").focus();
			}
			return;
		}

		// 약관동의 여부 체크
		if(false == chkStpltValid()) {
			return;
		}

		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 2번째 영역 표시
		$("div.formContainer[dispView='view03']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(2)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(2)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(2)").attr("aria-current", "step");
	} else if("view03" == dispView) {
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView, param);
		fnChkSelfMakeCustInfo();
	} else if("newSelf01" == dispView) {
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView, param);
		if($("div.newNumberCreate.createNumberInput").is(":visible")) {
			alert("사용하실 신규 번호를 조회해 주세요.");
			$("#tailFourTelNo").focus();
			return;
		}
		if($('#prodTypeCd').val() == 'W'){
			// 워치 개통처리
			fnUsimOpenProcess();
			return;
		}

		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		/** @신규가입 */
		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 납부 영역 표시
		$("div.formContainer[dispView='view04']").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(4)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(4)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(4)").attr("aria-current", "step");

	} else if("phoneMove01" == dispView) {
		$("#nextStepTxt").text("사전동의 요청");
		$("#goNextStep").attr("dynamicParamAttr1", "사전동의 요청");
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView,param);
		/** @번호이동_사전동의_처리 */
		//fnPhoneMoveSelf();

		fnPhoneMove();
	} else if("view04" == dispView) {
		var param = $(input).attr("dynamicParamAttr1");
		pushEventTagging(dispView,param);
		// 명세서 유형
		if(false == $(":radio[name='rqsshtPprfrmCd']").is(":checked")) {
			alert("명세서 유형을 선택해 주세요.");
			$(":radio[name='rqsshtPprfrmCd']:eq(0)").focus();
			return;
		}
		var rqsshtPprfrmCd = $(":radio[name='rqsshtPprfrmCd']:checked").val();
		if("CB" == rqsshtPprfrmCd) {
			validator.config={};
			validator.config['rqsshtEmlAdrsNm'] = 'isNonMail';

			if (!validator.validate()) {
				alert(validator.getErrorMsg());
				return;
			}
		}
		// 납부방법
		if(false == $(":radio[name='blpymMthdCd']").is(":checked")) {
			alert("납부방법을 선택해 주세요.");
			$(":radio[name='blpymMthdCd']:eq(0)").focus();
			return;
		}

		var blpymMthdCdVal = $(":radio[name='blpymMthdCd']:checked").val();
		if("D" == blpymMthdCdVal) {
			if("" == $("#bankCd").val()) {
				alert("은행을 선택해 주세요.");
				$(":button[name='bankBtn']:eq(0)").focus();
				return;
			}
			validator.config={};
			validator.config['blpymCustNmBk'] = 'isNonEmpty';
			validator.config['blpymMthdIdntNoBkTemp'] = 'isNonEmpty';

			if (!validator.validate()) {
				alert(validator.getErrorMsg());
				return;
			}
		} else if("C" == blpymMthdCdVal) {
			if("" == $("#cardCd").val()) {
				alert("카드사를 선택해 주세요.");
				$(":button[name='bankBtn']:eq(0)").focus();
				return;
			}
			var blpymMthdIdntNoCard = $("#blpymMthdIdntNoCard").val().replace(/\s/gi, "");
			if("" == blpymMthdIdntNoCard) {
				alert("납부하실 카드번호를 입력해 주세요.");
				$("#blpymMthdIdntNoCardTemp").focus();
				return;
			}
			var cardEffectMonth = $("#cardEffectMonth").val();
			if("" == cardEffectMonth) {
				alert("납부하실 카드 유효월을 선택해 주세요.");
				$(":button[name='cardMonthBtn']:eq(0)").focus();
				return;
			}
			var cardEffectYear = $("#cardEffectYear").val();
			if("" == cardEffectYear) {
				alert("납부하실 카드 유효년도를 선택해 주세요.");
				$(":button[name='cardYearBtn']:eq(0)").focus();
				return;
			}
		}

		if(false == controller.payValid) {
			alert("납부방법 유효성 체크를 해주시기 바랍니다.");
			return;
		}

		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
		//oderTypeCdCheck(oderTypeCd);

		// 개통처리
		fnUsimOpenProcess();
	}
	// 제일 위로 이동
	$('html, body').stop().animate({scrollTop: 0}, 0);
	// 포커스 초기화
	$("#contentContainer").focus();
}

/** @신규가입_화면_노출 */
function goNewJoinStep() {
	// 전체 영역 숨김처리
	$("div.formContainer").hide();
	// 신규가입 첫번째 영역 표시
	$("div.formContainer[dispView='newSelf01']").show();
	// 스텝 이동
	$("div.applySteps > ul > li").removeClass("current");
	$("div.applySteps > ul > li:eq(3)").addClass("current");
	// 셀프개통 타이틀 변경
	changeTitle();
	// 현재 단계 이동
	var htmlString = "<span class='message'>현재 단계</span>";
	$("div.applySteps > ul > li > span").remove();
	$("div.applySteps > ul > li:eq(3)").prepend(htmlString);
	$("div.applySteps > ul > li").attr("aria-current", null);
	$("div.applySteps > ul > li:eq(3)").attr("aria-current", "step");

	// 인증 시 전화번호 명세서 전화번호에 넣기
	$("#blpymCustNmBk").val($("#custName").val());

	if($('#prodTypeCd').val() == 'W'){
		$("#nextStepBtnArea").hide();
	}
}

/** @번호이동_화면_노출 */
function goMovePhoneStep() {

	if($("#loading").length > 0) {
		$("#loading").remove(); //혹시나해서
	}
	// 다음버튼 '사전동의 요청'으로 표기
	$("#nextStepTxt").text("사전동의 요청");

	// 전체 영역 숨김처리
	$("div.formContainer").hide();
	// 신규가입 첫번째 영역 표시
	$("div.formContainer[dispView='phoneMove01']").show();
	// 스텝 이동
	$("div.applySteps > ul > li").removeClass("current");
	$("div.applySteps > ul > li:eq(3)").addClass("current");
	// 셀프개통 타이틀 변경
	changeTitle();
	// 현재 단계 이동
	var htmlString = "<span class='message'>현재 단계</span>";
	$("div.applySteps > ul > li > span").remove();
	$("div.applySteps > ul > li:eq(3)").prepend(htmlString);
	$("div.applySteps > ul > li").attr("aria-current", null);
	$("div.applySteps > ul > li:eq(3)").attr("aria-current", "step");

	// 인증 시 전화번호 명세서 전화번호에 넣기
	$("#blpymCustNmBk").val($("#custName").val());
}

/** @사업자선택팝업_호출 */
function callBizrSelPop() {

	var varData = controller.getSerializedData({
		prodTypeCd : $("#prodTypeCd").val()
	});
	loadBlock();
	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/listSelfPossBizrInfo.json"
		,dataType:"json"
		,data: varData
		,isBlock:false
		,successCall:function(result){
			var bizrList = result.bizrList;

			// 화면 그리기
			var sb = new Array();
			for(var i=0; i<bizrList.length; i++) {
				var bizr = bizrList[i];
				sb.push('<li>');
				sb.push('	<div class="checkboxLine">');
				sb.push('		<input type="radio" id="bizrSelRdo'+i+'" name="bizrSelRdo" value="'+bizr.bizrSeq+'" />');
				sb.push('		<label for="bizrSelRdo'+i+'" class="checkboxLabel">');
				sb.push('			<span>'+bizr.brndNm+'</span>');
				sb.push('			<span class="checkIcon"></span>');
				sb.push('		</label>');
				sb.push('	</div>');
				sb.push('</li>');
			}
			// 사업자 화면 구성
			$("#bizrSelectViewUl").html(sb.join(''));
			// radio에 값 넣기
			for(var i=0; i<bizrList.length; i++) {
				$(":radio[name='bizrSelRdo']:eq("+i+")").data(bizrList[i]);
			}

			// 팝업 호출
			togglePopup('bizSelBtn', 'bizrSelectPopupView');

			getCretKeyRsaEncData("cretKey"); //키생성
			loadUnBlock();
		},errorCall:function() {
			alert("시스템이 정상적으로 작동하지않았습니다.\n시스템 관리자에게 문의하세요.");
			loadUnBlock();
		}
	});
}

/** @사업자선택팝업_선택처리 */
function bizrSelCmplt() {
	if(1 > $(":radio[name='bizrSelRdo']:checked").length) {
		alert("사업자를 선택해 주세요.");
		$(":radio[name='bizrSelRdo']:eq(0)").focus();
		return;
	}
	var bizrInfo = $(":radio[name='bizrSelRdo']:checked").data();
	var imgUrl = svcRouteURL + bizrInfo.brndLogoPath + bizrInfo.brndLogo;

	$("#bizrImgDiv").html('<img src="'+imgUrl+'" alt="'+bizrInfo.brndNm+'로고">');
	$("#bizrNmTxt").text(bizrInfo.brndNm);
	$("div.fixedFooterContainer").find("div.left > p.title").text(bizrInfo.brndNm);
	$("#bizrCctrTelNoTxt").text(bizrInfo.cctrTelNo);
	$("#bizrCctrUrlAtag").attr("href", bizrInfo.cctrUrl);
	$("#bizrCctrUrlAtag").text(bizrInfo.cctrUrl);
	$("#saleCmpnId").val(bizrInfo.saleCmpnId);
	var sb = new Array();
	if(null == bizrInfo.mbrBizrMngCctrNoResList) {
		sb.push('<div class="iconBgCall02"><span></span></div>');
		sb.push('<p id="bizrCctrTelNoTxt"></p>');
	} else {
		for(var i=0; i<bizrInfo.mbrBizrMngCctrNoResList.length; i++) {
			var mbrBizrMngCctrNoResList = bizrInfo.mbrBizrMngCctrNoResList[i];
			sb.push('<div class="iconBgCall02"><span>전화</span></div>');
			sb.push('<p id="bizrCctrTelNoTxt">전화('+mbrBizrMngCctrNoResList.cdNm+') : '+mbrBizrMngCctrNoResList.cctrNo+'</p>');
		}
	}
	$("#cctrTelDiv").html(sb.join(""));

	sb = new Array()
	if(null == bizrInfo.mbrBizrMngResList) {
		sb.push('<div class="text">');
		sb.push('	<div class="iconBgTime"><span>운영시간</span></div>');
		sb.push('	<p id="bizrOprtTimeTxt"></p>');
		sb.push('</div>');
	} else {
		for(var i=0; i<bizrInfo.mbrBizrMngResList.length; i++) {
			var mbrBizrMngRes = bizrInfo.mbrBizrMngResList[i];
			sb.push('<div class="text">');
			sb.push('	<div class="iconBgTime"><span>운영시간</span></div>');
			sb.push('	<p id="bizrOprtTimeTxt">'+mbrBizrMngRes.cdNm+' '+mbrBizrMngRes.workTime+'</p>');
			sb.push('</div>');
		}
	}
	$("#oprtTimeDiv").html(sb.join(""));

	// 알뜰폰 사업자 선택 전 영역 숨기기
	$("#bizrSelDiv").hide();
	// 알뜬폰 사업자 노출 영역 노출
	$("#bizrViewDiv").show();

	// 사업자 선택 완료시 아이디 중복 사용 방지를 위해 버튼 아이디 제거 후 id = bizSelBtn2에 아이디 추가
	//$("#bizSelBtn").removeAttr('id');
	$("#bizSelBtn2").attr('id','bizSelBtn');

	// 요금제 초기화
	if($("div#pplViewDiv").is(":visible")) {
		$("div#pplViewDiv").hide();
		$("div#pplSelDiv").show();

		// 요금제 값 초기화
		$("#pplId").val("");
		$("#basChage").val("0");
		$("#promDc").val("0");
		$("#monthCommChage").val("0");
		$("#monthPayAmt").val("0");
		$(":radio[name='oderTypeCd']").prop("disabled", false);
		$("div.fixedFooterContainer").find("div.left > p.desc").text("");
		$("div.fixedFooterContainer").find("div.right > div.desc > p.priceArea > span.price").text("0");

		// 시간에 따른 가입유형 가능여부 체크
		fnSbscTypeCdPoss();
	}

	// 팝업 닫기
	if($("#bizrSelectPopupView").hasClass("show")) {
		togglePopup('bizSelBtn', 'bizrSelectPopupView');
	}
}

/** @요금제선택팝업_호출 */
function callPplSelPop(pageNo, funcBtn) {
	if("" == $("#saleCmpnId").val()) {
		alert("알뜰폰 사업자를 선택해 주세요.");
		$("#bizSelBtn").focus();
		return;
	}

	var varData = controller.getSerializedData({
		pageNo : pageNo
		, prodTypeCd : $("#prodTypeCd").val()
		, paramSaleCmpnId : $("#saleCmpnId").val()
		, sortType : controller.sortType
		, selfPossCd : $("#selfPossCd").val()
		, funcBtn : funcBtn
		, selfLinkReqYn : $("#selfBizrMappPplYn").val()
	});

	controller.ajaxSendDone({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/listSelfPossPplInfo.thym"
		,data:varData
		,isBlock:true
		,replaceAttr:"#pplSelectPopupContentsView"
		,successCall:function(result){
			setTimeout(function() {
				if(typeof displayFnc == 'function') {
					/** 화면 css 스크립트 */
					displayFnc();
				}

				// 정렬 스크립트 동작
				//dropdownControl(".dropdownBtn");
				// 정렬 후 포커스 이동
				if('sort' == controller.focus){
					$(".dropdownBtn").focus();
				}

				// 팝업 호출(페이징 및 정렬이 있어서, 팝업이 안보일때만 호출 처리)
				if(false == $("#pplSelectPopupView").hasClass("show")) {
					togglePopup('pplSelBtn', 'pplSelectPopupView');
				}
			}, 200);

			// 포커스 초기화
			controller.focus = "";
		}
	});
}

/** @요금제선택팝업_선택 */
function pplSelCmplt() {
	if(1 > $(":radio[name='pplListChk']:checked").length) {
		alert("요금제를 선택해 주세요.");
		$(":radio[name='pplListChk']:eq(0)").focus();
		return;
	}

	var pplId = $(":radio[name='pplListChk']:checked").val();
	var pplNm = $(":radio[name='pplListChk']:checked").attr("pplNm");
	var sbscTypeCd = $(":radio[name='pplListChk']:checked").attr("sbscTypeCd");

	$("div.fixedFooterContainer").find("div.left > p.desc").text(pplNm);
	$("#pplId").val(pplId);

	// 요금제 금액
	var pplAmt = $(":radio[name='pplListChk']:checked").parent().siblings(".popularDataArea").find("dl.usageItem:eq(0) > dd > span").text();
	var basChage = pplAmt.replace(/[^0-9]/gi, "");
	$("#basChage").val(basChage);

	$("#promDc").val("0");
	if($(":radio[name='pplListChk']:checked").parent().siblings(".popularDataArea").find("dl.usageItem").length > 1) {
		pplAmt = $(":radio[name='pplListChk']:checked").parent().siblings(".popularDataArea").find("dl.usageItem:eq(1) > dd > span").text();
		var promDc = parseInt(basChage) - parseInt(pplAmt.replace(/[^0-9]/gi, ""));
		$("#promDc").val(promDc);
	}
	$("#monthCommChage").val(pplAmt.replace(/[^0-9]/gi, ""));
	$("#monthPayAmt").val(pplAmt.replace(/[^0-9]/gi, ""));

	$("div.fixedFooterContainer").find("div.right > div.desc > p.priceArea > span.price").text(pplAmt);

	// 선택 요금제 영역
	var pplArea = $(":radio[name='pplListChk']:checked").parent().siblings(".popularDataArea");
	$("#pplViewDiv > div.popularDataArea").html(pplArea);

	/** 요금제 가입유형에 따른 활성화 처리 */
	// 전체 활성화 처리
	$(":radio[name='oderTypeCd']").prop("disabled", false);
	// 신규가입 불가능
	if(sbscTypeCd.indexOf("01") < 0) {
		$(":radio[id='oderTypeCd01']").prop("disabled", true);
		$(":radio[id='oderTypeCd01']").prop("checked", false);
	}
	// 번호이동 불가능
	if(sbscTypeCd.indexOf("02") < 0) {
		$(":radio[id='oderTypeCd02']").prop("disabled", true);
		$(":radio[id='oderTypeCd02']").prop("checked", false);
	}

	var tngrPplYn = $(":radio[name='pplListChk']:checked").attr("tngrPplYn");
	var sbscPosblAge = $(":radio[name='pplListChk']:checked").attr("posblAge");

	// 연령 전용 요금제여부 && 가입 가능 나이 체크
	var sbscPosblAgeCk = false;
	if("S" == tngrPplYn && (null != sbscPosblAge && "0" != sbscPosblAge) ) {
		sbscPosblAgeCk = true;
	}

	// 시간에 따른 가입유형 가능여부 체크
	fnSbscTypeCdPoss();

	$("#pplSelDiv").hide();
	$("#pplViewDiv").show();

	// 요금제 선택 완료시 아이디 중복 사용 방지를 위해 버튼 아이디 제거 후 id = pplSelBtn2에 아이디 추가
	//$("#pplSelBtn").removeAttr('id');
	$("#pplSelBtn2").attr('id','pplSelBtn');

	// 팝업 닫기
	if($("#pplSelectPopupView").hasClass("show")) {
		togglePopup('pplSelBtn', 'pplSelectPopupView');
	}

	// 시니어 요금제 선택 시 알림 팝업 노출
	if(sbscPosblAgeCk) {
		$("#popupSeniorNoticeContent").html("시니어 요금제를 선택하였습니다. <br>※ 만 "+ sbscPosblAge +"세 이상 가입 가능");
		togglePopup("btnSeniorNotice", 'popupSeniorNotice');
	}

}

/** @본인인증_선택 */
function fnCertifyPrc(idVal) {
	if("" == $("#certNm").val()) {
		alert("이름을 입력하여 주시기 바랍니다.");
		$("#certNmTemp").focus();
		return;
	}
	if("" == $("#certRssNo").val()) {
		alert("주민등록번호를 입력하여 주시기 바랍니다.");
		$("#certRssNoTemp").focus();
		return;
	}
	if(13 > $("#certRssNo").val().length) {
		alert("주민등록번호 13자리를 입력해 주세요.");
		$("#certRssNoTemp").focus();
		return;
	}
	var pattern = /[^0-9]/gi;
	if (pattern.test($("#certRssNo").val())) {
		alert("숫자만 입력 가능합니다.");
		$("#certRssNoTemp").focus();
		return;
	}

	var _class = idVal;
	if("pass" == _class){
		$("#authType").val("1");
		athnPassPopupWindow();
	}else if("card" == _class){
		$("#authType").val("2");
		athnCreditCardPopupWindow();
	}
}

/** @PASS_팝업_호출 */
function athnPassPopupWindow(){
    var w = 500;
    var h = 644;
    var x = (screen.availWidth - w) / 2;
    var y = (screen.availHeight - h) / 2;

    window.open("",'smsCertPop','scrollbars=no,resizable=no,width='+w+'px,height='+h+'px,left='+x+'px,top='+y+'px');
    controller.createForm({
        id:"viewFrm"
        ,name:"viewFrm"
        ,method:"post"
        ,target:"smsCertPop"
        ,action: '/fe/mypage/common/PassAthnReq.do'
    });
    controller.attachHiddenElement("callUrl", location.href);
    controller.attachHiddenElement("jobCd", '10');

    controller.formSubmit();
}

/** @PASS_콜백 */
function passReturn() {
	fnCustAuthInfoChk();
}

/** @신용카드_팝업_호출 */
function athnCreditCardPopupWindow(){
	var controller = $.extend(new $.CommonObj(),{});
	controller.init();

	if (!validator.validate()) {
		alert(validator.getErrorMsg());
		return;
	}

	var w = 430;
	var h = 712;
	var x = (screen.availWidth - w) / 2;
	var y = (screen.availHeight - h) / 2;

	window.open("",'kcbCardCertPop','scrollbars=no,resizable=no,width='+w+'px,height='+h+'px,left='+x+'px,top='+y+'px');
	controller.createForm({
	  	id:"viewFrm"
	  	,name:"viewFrm"
	  	,method:"post"
	  	,target:"kcbCardCertPop"
	  	,action: '/fe/mypage/common/CardAthnPopupInfo.do'
	});

	/* 넘겨줄값 세팅 */
	controller.attachHiddenElement("callUrl", location.href);
	controller.attachHiddenElement("jobCd", '10');

	controller.formSubmit();
}

/** @신용카드_콜백 */
function cardCertReturn() {
	fnCustAuthInfoChk();
}

/** @본인인증_사전체크 */
function fnCustAuthInfoChk() {
	var varData = controller.getSerializedDataAllRSA({
		authType : $("#authType").val()
		, saleCmpnId : $("#saleCmpnId").val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/custAuthInfoChk.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			var validYn = result.validYn;
			if("Y" == validYn) {
				controller.custAuth = true;
				$("#custName").val($("#certNm").val());

				// 본인인증 아이콘 , 완료 후 이름, 주민등록번호, 연락처 disabled 처리
				$("#pass").attr("aria-disabled",true);
				$("#pass").attr('disabled',true);
				$("#card").attr("aria-disabled",true);
				$("#card").attr('disabled',true);
				if(String($("#btnCertPopup").attr('authType')) == "pass"){
					$("#passStatsTxt").text("PASS 인증 완료");
				}
				else if(String($("#btnCertPopup").attr('authType')) == "card"){
					$("#cardStatsTxt").text("신용카드 인증 완료");
				}
				$("#certNmTemp").prop("disabled", true);
				$("#certRssNoTemp").prop("disabled", true);
				$("#certCustPhoneNoTemp").prop("disabled", true);
				$("#selectPassCommCmp").prop("disabled", true);
				$("#PassAgreeCheck").prop("disabled", true); //PassAgreeCheck
				$("#btnCertPopup").attr('disabled',true);
				$("#btnCertPopup").removeClass("btnPrimary");
				$("#btnCertPopup").addClass("btnDim");
				$("#btnCertPopup").text("인증 완료");
			} else if("C" == validYn) {
				controller.custAuth = false;
				// 셀프개통 불가 안내 팝업 노출
				$("#commonAlertPopupTitle").text("셀프개통 불가 안내");
				$("#commonAlertPopupContent").html("회선 개통 제한으로 셀프 개통이 불가능합니다.<br>90일 이내 셀프개통은 1회선(사업자 합산)으로 제한되어 있습니다.");
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')
			} else {
				controller.custAuth = false;
			}

		},errorCall:function() {
			controller.custAuth = false;
		}
	});
}

/** @주소조회_팝업호출 */
//function fnSearchAddr() {
//	window.open(svcRouteURL + "/fe/service/common/JusoController.do","pop","width=570,height=650, scrollbars=yes, resizable=yes");
//}

/** @주소조회_콜백함수 */
function jusoCallBack(roadFullAddr,roadAddrPart1,addrDetail,roadAddrPart2,engAddr, jibunAddr, zipNo, admCd, rnMgtSn, bdMgtSn,detBdNmList,bdNm,bdKdcd,siNm,sggNm,emdNm,liNm,rn,udrtYn,buldMnnm,buldSlno,mtYn,lnbrMnnm,lnbrSlno,emdNo){
	// 팝업페이지에서 주소입력한 정보를 받아서, 현 페이지에 정보를 등록합니다.
	$("#zipCd").val(zipNo);
	$("#custAddr").val(roadAddrPart1);
	$("#custAddrDtl").val(addrDetail);
	setTimeout(function() {
		$("#btnCustAddr").focus();
	}, 1000);
}

/** @신규가입_사전체크_고객생성 */
function fnChkSelfMakeCustInfo(input, type) {
	validator.config={};
	validator.config['custName'] = 'isNonEmpty';
	validator.config['custPhoneNo'] = 'isNumBetterFixN11';
	validator.config['custAddr'] = 'isNonEmpty';
	validator.config['custAddrDtl'] = 'isNonEmpty';
	validator.config['custMail'] = 'isNonMail';

	if (!validator.validate() && $("#prodTypeCd").val() != "W") {
		alert(validator.getErrorMsg());
		return;
	}

	// 신분증 확인 동의 약관
	if(false == $(":checkbox[id='idCardTypeChk']").is(":checked")) {
		alert("본인 조회에 동의 해주시기 바랍니다.");
		$(":checkbox[id='idCardTypeChk']").focus();
		return;
	}
	// 신분증 선택여부
	if(1 > $(":checkbox[id='idCardTypeChk']:checked").length) {
		alert("신분증 선택을 해주시기 바랍니다.");
		$(":checkbox[id='idCardTypeChk']:eq(0)").focus();
		return;
	}

	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	// 2023.03.22 긴급배포건 신규가입 불가능 처리
	// 2023.05.09 주석 처리
	//oderTypeCdCheck(oderTypeCd);

	validator.config={};
	// 신분증 종류
	var rsdcrtIssuDate = "";
	var nativeRlnamAthnEvdnPprCd = "";
	var chkCardTypeId = $(":radio[name='idCardType']:checked").attr("id");
	if("idCardType01" == chkCardTypeId) {
		validator.config['rssnoRegDate'] = 'isNonEmpty';

		rsdcrtIssuDate = $("#rssnoRegDate").val().replace(/\./g,"");
		nativeRlnamAthnEvdnPprCd = "REGID";

		//오늘날짜 구하기
		var nowDate = new Date();
		var year = nowDate.getFullYear();
		var month = nowDate.getMonth() + 1;
		if(month <= 9) {
			month = '0' + month;
		} else {
			month = month + '';
		}

		var day = nowDate.getDate();
		if(day <= 9) {
			day = '0' + day;
		} else {
			day = day + '';
		}

		var updateDate = year + month + day;

		//주민등록번호 발급일자는 오늘날짜를 초과해서 입력해서는 안됨
		if(rsdcrtIssuDate > updateDate || rsdcrtIssuDate.length < 8) {
			alert("주민등록증의 발급일자를 정확히 입력해주세요.");

			var title = document.getElementById("rssnoRegDate");
			setTimeout(function(){title.focus();},1);

			return;
		}
		//운전면허증의 발급일자 유효성검사 로직 ( 끝 )

	} else if("idCardType02" == chkCardTypeId) {
		rsdcrtIssuDate = $("#lcnsRegDate").val().replace(/\./g,"");

		//오늘날짜 구하기
		var nowDate = new Date();
		var year = nowDate.getFullYear();
		var month = nowDate.getMonth() + 1;
		if(month <= 9) {
			month = '0' + month;
		} else {
			month = month + '';
		}

		var day = nowDate.getDate();
		if(day <= 9) {
			day = '0' + day;
		} else {
			day = day + '';
		}

		var updateDate = year + month + day;

		//운전면허증의 발급일자는 오늘날짜를 초과해서 입력해서는 안됨
		if(rsdcrtIssuDate > updateDate || rsdcrtIssuDate.length < 8) { //2023
			alert("운전면허증의 발급일자를 정확히 입력해주세요.");

			var title = document.getElementById("lcnsRegDate");
			setTimeout(function(){title.focus();},1);

			return;
		}
		//운전면허증의 발급일자 유효성검사 로직 ( 끝 )

		if("" == $("#lcnsRgnCd").val()) {
			alert("면허지역코드를 선택해 주세요.");
			$(":button[name='lcnsAreaBtn']:eq(0)").focus();
			return;
		}

		validator.config['lcnsRegDate'] = 'isNonEmpty';
		validator.config['lcnsNo'] = 'isNonEmpty';

		nativeRlnamAthnEvdnPprCd = "DRIVE";
	} else if("idCardType03" == chkCardTypeId) {
		validator.config['dsbPrsnRegDate'] = 'isNonEmpty';

		rsdcrtIssuDate = $("#dsbPrsnRegDate").val().replace(/\./g,"");
		nativeRlnamAthnEvdnPprCd = "HANDI";

		//오늘날짜 구하기
		var nowDate = new Date();
		var year = nowDate.getFullYear();
		var month = nowDate.getMonth() + 1;
		if(month <= 9) {
			month = '0' + month;
		} else {
			month = month + '';
		}

		var day = nowDate.getDate();
		if(day <= 9) {
			day = '0' + day;
		} else {
			day = day + '';
		}

		var updateDate = year + month + day;

		//장애인등록증의 발급일자는 오늘날짜를 초과해서 입력해서는 안됨
		if(rsdcrtIssuDate > updateDate || rsdcrtIssuDate.length < 8) {
			alert("장애인등록증의 발급일자를 정확히 입력해주세요.");

			var title = document.getElementById("dsbPrsnRegDate");
			setTimeout(function(){title.focus();},1);

			return;
		}
		//장애인등록증의 발급일자 유효성검사 로직 ( 끝 )
	} else if("idCardType04" == chkCardTypeId) {
		rsdcrtIssuDate = $("#mrtrPrsnDate").val().replace(/\./g,"");

		validator.config['mrtrPrsnDate'] = 'isNonEmpty';
		validator.config['mrtrPrsnNo'] = 'isNonEmpty';

		nativeRlnamAthnEvdnPprCd = "MERIT";

		//오늘날짜 구하기
		var nowDate = new Date();
		var year = nowDate.getFullYear();
		var month = nowDate.getMonth() + 1;
		if(month <= 9) {
			month = '0' + month;
		} else {
			month = month + '';
		}

		var day = nowDate.getDate();
		if(day <= 9) {
			day = '0' + day;
		} else {
			day = day + '';
		}

		var updateDate = year + month + day;

		//국가유공자의 발급일자는 오늘날짜를 초과해서 입력해서는 안됨
		if(rsdcrtIssuDate > updateDate || rsdcrtIssuDate.length < 8) {
			alert("국가유공자의 발급일자를 정확히 입력해주세요.");

			var title = document.getElementById("mrtrPrsnDate");
			setTimeout(function(){title.focus();},1);

			return;
		}
		//국가유공자의 발급일자 유효성검사 로직 ( 끝 )
	}

	if (!validator.validate()) {
		alert(validator.getErrorMsg());
		return;
	}

	var brthDate = $("#certRssNo").val().substring(0, 6);
	var gender = $("#certRssNo").val().substring(6, 7);
	if("1" == gender || "2" == gender) {
		brthDate = "19"+brthDate
	} else {
		brthDate = "20"+brthDate
	}

	// 가입유형
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	// 번호이동의 경우 번호이동 사전동의까지하고 나서 하기 때문에 여기선 스킵처리
	// isBfacAgreeRpyRetv 사전동의 결과가 성공이면, 고객생성 진행
	if("02" == oderTypeCd && false == controller.isBfacAgreeRpyRetv) {
		goMovePhoneStep();
	} else {
		// 2023.03.22 긴급배포건 신규가입 불가능 처리
		// 2023.05.09 주석 처리
		//oderTypeCdCheck(oderTypeCd);
		// 고객생성 했으면, 페이지 이동 처리
		if("01" == oderTypeCd && controller.isMakeCust) {
			goNewJoinStep();
			return;
		}

		// 번호이동은 따로 문구 변경하여 돌리고 있음
		if("01" == oderTypeCd) {
			// socket통신이 완료 되야 해당 사전체크가 끝난 것이므로 수동 실행
			loadBlock();
		}

		// 인증항목코드
		var athnItemCd = "";
		var athnSbst = "";

		if("02" == oderTypeCd) {
			athnItemCd = $("#npAthnCd").val();
			if("2" == athnItemCd) {
				athnSbst = $("#npPhoneSrilNum").val();
			} else if("3" == athnItemCd) {
				athnSbst = $("#npBlpymMthdBankNo").val();
			} else if("5" == athnItemCd) {
				athnSbst = $("#npBlpymMthdCardNo").val();
			}
		}

		var varData = controller.getSerializedDataAllRSA({
			slsCmpnCd : $("#saleCmpnId").val()
			, nativeRlnamAthnEvdnPprCd : nativeRlnamAthnEvdnPprCd
			, athnRqstcustCntplcNo : $("#custPhoneNo").val()
			, rsdcrtIssuDate : rsdcrtIssuDate
			, lcnsNo : $("#lcnsNo").val()
			, lcnsRgnCd : $("#lcnsRgnCd").val()
			, mrtrPrsnNo : $("#mrtrPrsnNo").val()
			, wrlnTlphNo : $("#custPhoneNo").val()
			, tlphNo : $("#custPhoneNo").val()
			, brthDate : brthDate
			, brthNnpIndCd : "0"
			, emlAdrsNm : $("#custMail").val()
			, oderTypeCd : oderTypeCd
			, athnItemCd : athnItemCd
			, athnSbst : athnSbst
			, prodTypeCd : $("#prodTypeCd").val()
		});

		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/chkSelfMakeCustInfo.json"
			,data:varData
			,dataType:"json"
			,isBlock:false
			,successCall:function(result){
				var custInfoMakeYn = result.custInfoMakeYn;
				if("Y" == custInfoMakeYn) {
					// 연동 결과 확인
					fnCustMake = setInterval(function() {
						fnCustMakeConfirm(input, type);
					}, 7000);
				} else {
					if("02" == oderTypeCd) {
						controller.isBfacAgreeRpyRetv = false;
						togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
					}
					$("#commonAlertPopupTitle").text("사전체크 고객생성");
					$("#commonAlertPopupContent").text("셀프개통이 정상적으로 진행되지 않습니다. 다음에 다시 시도해 주세요.");
					togglePopup('commonAlertPopupBtn', 'commonAlertPopup');

					loadUnBlock();
				}

			},errorCall:function() {
				loadUnBlock();
				if("02" == oderTypeCd && $("#phoneMoveProcIngPop.show").length > 0) {
					controller.isBfacAgreeRpyRetv = false;
					togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				}
			}
		});
	}
}

/** @사전체크_고객생성_연동결과확인 */
function fnCustMakeConfirm(input, type) {
	// 가입유형
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	// 2023.03.22 긴급배포건 신규가입 불가능 처리
	// 2023.05.09 주석 처리
	//oderTypeCdCheck(oderTypeCd);

	var varData = controller.getSerializedData({
		prgrStatCd : "PC2"
		, saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
		, prodTypeCd : $("#prodTypeCd").val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/searchOpenProcessInfo.json"
		,data:varData
		,dataType:"json"
		,isBlock:false
		,async:false
		,successCall:function(result){
			if("Y" == result.goStepYn) {
				clearInterval(fnCustMake);
				// 다음화면 이동
				var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

				if("01" == oderTypeCd) {
					// 신규가입
					goNewJoinStep();

					// 고객생성 성공처리
					controller.isMakeCust = true;
				} else if("02" == oderTypeCd) {
					// 번호이동 처리 팝업 닫기
					if($("#npCmpnArsPop.show").length > 0) {
						togglePopup('npCmpnArsPopBtn', 'npCmpnArsPop');
					}
					if($("#phoneMoveProcIngPop.show").length > 0) {
						togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
					}
					// 번호이동(납부방법으로 이동 처리)
					// 전체 영역 숨김처리
					$("div.formContainer").hide();
					// 납부 영역 표시
					$("div.formContainer[dispView='view04']").show();
					// 스텝 이동
					$("div.applySteps > ul > li").removeClass("current");
					$("div.applySteps > ul > li:eq(4)").addClass("current");
					// 셀프개통 타이틀 변경
					changeTitle();
					// 현재 단계 이동
					var htmlString = "<span class='message'>현재 단계</span>";
					$("div.applySteps > ul > li > span").remove();
					$("div.applySteps > ul > li:eq(4)").prepend(htmlString);
					$("div.applySteps > ul > li").attr("aria-current", null);
					$("div.applySteps > ul > li:eq(4)").attr("aria-current", "step");
					// 다음 버튼 노출 처리
					$("#nextStepTxt").text("다음");
					$("#nextStepBtnArea").show();

					// 고객생성 성공처리
					controller.isMakeCust = true;
				}
				loadUnBlock();
			} else if("Z" == result.goStepYn) {
				clearInterval(fnCustMake);
				// 팝업닫기
				if($("#phoneMoveProcIngPop.show").length > 0) {
					togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				}
				loadUnBlock();
				if(input) {
					//화면이동
					fnPhoneMoveBfacAgree();
				} else {
					if("M" == type){
						togglePopup('popupMoveFail01', 'popupMoveFail01');
					}else if("T" == type){
						togglePopup('popupMoveFail02', 'popupMoveFail02');
					}
				}
			}
		}
		,errorCall:function() {
			// 창 닫기
			if($("#phoneMoveProcIngPop.show").length > 0) {
				togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
			}
			clearInterval(fnCustMake);
			loadUnBlock();
		}
	});
}

function fnPhoneMoveBfacAgree() {
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	var varData = controller.getSerializedDataAllRSA({
		slsCmpnCd : $("#saleCmpnId").val()
		, npTlphNo : $("#npTlphNo").val()
		, bchngNpCommCmpnCd : $("#bchngNpCommCmpnCd").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgree.json"
		,data:varData
		,dataType:"json"
		,async:false
		,isBlock:true
		,successCall:function(result){
			var bfacAgreeYn = result.bfacAgreeYn;
			// 사전동의 성공
			if("Y" == bfacAgreeYn) {
				// 사전동의 성공처리
				controller.isBfacAgree = true;
				// 다음버튼 영역 숨김
				$("#nextStepBtnArea").hide();
				// 전체 영역 숨김처리
				$("div.formContainer").hide();
				// 번호이동2 영역 표시
				$("div.formContainer[dispView='phoneMove02']").show();
			} else if("T" == bfacAgreeYn) {
				// 사전동의 성공처리
				controller.isBfacAgree = true;
				// 다음버튼 영역 숨김
				$("#nextStepBtnArea").hide();
				// 전체 영역 숨김처리
				$("div.formContainer").hide();
				// 번호이동2 영역 표시
				$("div.formContainer[dispView='phoneMove02']").show();
				// ARS에 동의 및 조회 하는곳을 조회만으로 변경
				$("#npCmpnArsChkBtn").attr("onclick", "fnChkPhoneMoveSelf('T')");
			}
		}
	});
}

function fnReCustMakeConfirm1() {
	togglePopup('popupMoveFail01', 'popupMoveFail01');
	togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
	loadBlock();
	fnCustMake = setInterval(function() {
		fnCustMakeConfirm(false, 'M');
	}, 7000);
}

function fnReCustMakeConfirm2() {
	togglePopup('popupMoveFail02', 'popupMoveFail02');
	togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
	loadBlock();
	fnCustMake = setInterval(function() {
		fnCustMakeConfirm(false, 'T');
	}, 7000);
}

/** @신규번호_조회 */
function goNewTelNoSearch() {
	if(1 > controller.searchCnt) {
		alert("번호 조회 가능 횟수가 초과 되었습니다.");
		return;
	}

	validator.config={};
	validator.config['tailFourTelNo'] = 'isNumFix4';

	if($(".captchaArea").is(":visible")) {
		validator.config['answer'] = 'isNumFix6';
	}

	if (!validator.validate()) {
		alert(validator.getErrorMsg());
		return;
	}

	var varData = controller.getSerializedData({
		tailFourTelNo : $("#tailFourTelNo").val()
		, saleCmpnId : $("#saleCmpnId").val()
		, answer : $("#answer").val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/getHopeTelNo.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			// 신규가입 번호 조회 횟수 저장
			controller.searchCnt = controller.searchCnt-1;

			var hopeTelBean = result.hopeTelBean;
			var hopeTelList = hopeTelBean.inqrOsstSvcNoInfoList;

			if(1 > hopeTelList.length) {
				// 팝업 호출
				togglePopup('newTelNoSearchBtn', 'selfNewPhoneNoNotPop');
			} else {
				var sb = new Array();
				for(var i=0; i<hopeTelList.length; i++) {
					sb.push('<li>');
					sb.push('	<div class="radio">');
					sb.push('		<input type="radio" id="newPhoneNo'+i+'" name="newPhoneNo">');
					sb.push('		<label for="newPhoneNo'+i+'" class="radioLabel"><span>'+hopeTelList[i].tlphNo+'</span></label>');
					sb.push('	</div>');
					sb.push('</li>');
				}
				// 신규번호 조회 화면 구성
				$("#newPhoneNoViewUI").html(sb.join(''));

				// radio에 값 넣기
				for(var i=0; i<hopeTelList.length; i++) {
					$(":radio[name='newPhoneNo']:eq("+i+")").data(hopeTelList[i]);
				}

				// 팝업 호출
				togglePopup('newTelNoSearchBtn', 'selfNewPhoneNoPop');
			}

			$(".searchCnt").text(controller.searchCnt);

			// 10회 시도 시 캡챠 호출
			if("Y" == hopeTelBean.captchaYn) {
				getImage();
				// 보안문자 노출
				$(".captchaArea").show();
			}
		}
	});
}

/** @신규번호_선택 */
function selfNewPhoneNoChoice() {
	if(1 > $(":radio[name='newPhoneNo']:checked").length) {
		alert("사용하실 번호를 선택해 주세요.");
		$(":radio[name='newPhoneNo']:eq(0)").focus();
		return;
	}

	var chkObj = $(":radio[name='newPhoneNo']:checked").data();
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	var varData = controller.getSerializedDataAllRSA({
		gubun : "RSV"
		, tlphNo : chkObj.tlphNo.replace(/\-/g,"")
		, tlphNoStatChngRsnCd : "RSV"
		, tlphNoStatCd : "AR"
		, encdTlphNo : chkObj.encdTlphNo
		, saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/rsrvHopeTelNo.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			var rsrvHopeTelYn = result.rsrvHopeTelYn;
			if("Y" == rsrvHopeTelYn) {
				// 해지를 위해 값 저장
				controller.phoneNoData = chkObj;

				// 선택한 번호 표기
				var sb = new Array();
				sb.push("<span>");
				sb.push(chkObj.tlphNo.split("-")[0]);
				sb.push("</span>");
				sb.push("<span>");
				sb.push(chkObj.tlphNo.split("-")[1]);
				sb.push("</span>");
				sb.push("<span>");
				sb.push(chkObj.tlphNo.split("-")[2]);
				sb.push("</span>");
				$("#newTelNoShowDiv").html(sb.join(''));

				$("div.newNumberCreate.createNumberInput").hide();
				$("div.newNumberCreate.createComplete").show();
				// 조회 번호 초기화
				$("#tailFourTelNo").val("");
				// 명세서 전화번호
				$("#rqsshtTlphNo").val(chkObj.tlphNo.replace(/\-/g,""));

				// 팝업 닫기
				togglePopup('cancelNewTelNoSearchBtn', 'selfNewPhoneNoPop');
			}
		}
	});
}

/** @신규번호_취소 */
function fnNewTelNoCancel() {
	if(!confirm("선택한 번호를 취소하시겠습니까?")) {
		return;
	}
	if(0 == controller.searchCnt) {
		alert("번호 취소가 불가능합니다.");
		return;
	}

	var chkObj = $(":radio[name='newPhoneNo']:checked").data();

	var varData = controller.getSerializedDataAllRSA({
		gubun : "RRS"
		, tlphNo : controller.phoneNoData.tlphNo.replace(/\-/g,"")
		, tlphNoStatChngRsnCd : "RRS"
		, tlphNoStatCd : "AA"
		, encdTlphNo : controller.phoneNoData.encdTlphNo
		, saleCmpnId : $("#saleCmpnId").val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/rsrvHopeTelNo.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			var rsrvHopeTelYn = result.rsrvHopeTelYn;
			if("Y" == rsrvHopeTelYn) {
				$("div.newNumberCreate.createNumberInput").show();
				$("div.newNumberCreate.createComplete").hide();

				$("#newTelNoShowDiv").html("");
				// 명세서 전화번호
				$("#rqsshtTlphNo").val("");
			}
		}
	});
}

/** @번호이동_이전통신사_선택 */
function fnNpCmpnSubmit() {
	var npCmpnVal = $(":radio[name='npCmpnRadio']:checked").val();
	$("#bchngNpCommCmpnCd").val(npCmpnVal);

	// 버튼명 변경
	var npCmpnTxt = $(":radio[name='npCmpnRadio']:checked").next("label").children().text();
	$("#bchngNpCommCmpnBtn").text(npCmpnTxt);

	// 선택된 통신사 ARS 값 넣기
	var npCmpnGrpVal = $(":radio[name='npCmpnRadio']:checked").attr("cmpnGrp");
	if("01" == npCmpnGrpVal) {
		$("#arsCmpnTxt").text("KT");
		$("#arsCmpnPhoneNo").text("1588-2935");
	} else if("02" == npCmpnGrpVal) {
		$("#arsCmpnTxt").text("LG");
		$("#arsCmpnPhoneNo").text("1544-3553");
	} else if("03" == npCmpnGrpVal) {
		$("#arsCmpnTxt").text("SKT");
		$("#arsCmpnPhoneNo").text("1599-0133");
	}

	// 세부적인 통신사 구분
	if("KCT" == npCmpnVal) {
		$("#arsCmpnPhoneNo").text("1877-9120");
	}

	// 창 닫기
	togglePopup('bchngNpCommCmpnBtn', 'bchngNpCommCmpnPop');
}

function fnPhoneMove() {
    validator.config={};
	validator.config['npTlphNo'] = 'isNumBetterFixN10';

	if("" == $("#npAthnCd").val()) {
		alert("번호이동 인증유형을 선택해 주세요.");
		$(":radio[name='npAthnCdRadio']:eq(0)").focus();
		return;
	}

	var npAthnCdVal = $("#npAthnCd").val();
	if("2" == npAthnCdVal) {
		validator.config['npPhoneSrilNum'] = 'isNonEmpty';
	} else if("3" == npAthnCdVal) {
		validator.config['npBlpymMthdBankNo'] = 'isNonEmpty';
	} else if("5" == npAthnCdVal) {
		validator.config['npBlpymMthdCardNo'] = 'isNonEmpty';
	}

	if (!validator.validate()) {
		alert(validator.getErrorMsg());
		return;
	}

	if($("#npAthnCd").val() == 2) {
		togglePopup('btnMoveNotice03', 'popupMoveNotice03');
    } else if($("#npAthnCd").val() == 3) {
    	togglePopup('btnMoveNotice04', 'popupMoveNotice04');
    } else if($("#npAthnCd").val() == 5) {
    	togglePopup('btnMoveNotice05', 'popupMoveNotice05');
    }
}

function btnIsBfacAgree(input) {
	if("03" == input) {
		togglePopup('btnMoveNotice03', 'popupMoveNotice03');
	} else if("04" == input) {
		togglePopup('btnMoveNotice04', 'popupMoveNotice04');
	} else if("05" == input) {
		togglePopup('btnMoveNotice05', 'popupMoveNotice05');
	}

	fnPhoneMoveSelf(); //다음영역으로 화면이동함
}

/** @번호이동_사전동의 */
function fnPhoneMoveSelf() {
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	// 2023.03.22 긴급배포건 신규가입 불가능 처리
	// 2023.05.09 주석 처리
	//oderTypeCdCheck(oderTypeCd);

	// 사전동의 결과조회 로직 추가.
	var varData = controller.getSerializedDataAllRSA({
		initFlag : "Y"
		, slsCmpnCd : $("#saleCmpnId").val()
		, npTlphNo : $("#npTlphNo").val()
		, bchngNpCommCmpnCd : $("#bchngNpCommCmpnCd").val()
		, oderTypeCd : oderTypeCd
	});
	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgreeRpyRetv.json"
		,data:varData
		,dataType:"json"
		,async:false
		,isBlock:false
		,successCall:function(result){
			var npRpyRetvYn = result.npRpyRetvYn;
			// 사전동의 성공
			if("Y" == npRpyRetvYn) {
				// 창 열기
				togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				// 로딩문구때문에, 따로 실행
				if($("#loading").length == 0) {
					$("body").prepend('<div id="loading"><div class="iconLoading"></div><p>번호 이동 처리는 최대 2분까지 소요될 수 있습니다.</p></div>');
				}

				// 사전동의 결과 성공처리
				controller.isBfacAgreeRpyRetv = true;
				// 사전동의 요청 성공처리
				controller.isBfacAgree = true;

				// 명세서 전화번호
				var npTlphNo = $("#npTlphNo").val();
				$("#rqsshtTlphNo").val(npTlphNo);

				// 번호이동 고객생성 START
				fnChkSelfMakeCustInfo(true, '');
			}
		},errorCall:function() {
			// 로딩바 제거
			loadUnBlock();
		}
	});

	// 이미 사전체크 성공 했으면 화면 이동만
	if(controller.isBfacAgree && !controller.isBfacAgreeRpyRetv) {
		// 다음버튼 영역 숨김
		$("#nextStepBtnArea").hide();
		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 번호이동2 영역 표시
		$("div.formContainer[dispView='phoneMove02']").show();
		return;
	}

	if(!controller.isBfacAgreeRpyRetv) {
		var varData = controller.getSerializedDataAllRSA({
			slsCmpnCd : $("#saleCmpnId").val()
			, npTlphNo : $("#npTlphNo").val()
			, bchngNpCommCmpnCd : $("#bchngNpCommCmpnCd").val()
			, oderTypeCd : oderTypeCd
		});
		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgree.json"
			,data:varData
			,dataType:"json"
			,async:false
			,isBlock:true
			,successCall:function(result){
				var bfacAgreeYn = result.bfacAgreeYn;
				// 사전동의 성공
				if("Y" == bfacAgreeYn) {
					// 사전동의 성공처리
					controller.isBfacAgree = true;
					// 다음버튼 영역 숨김
					$("#nextStepBtnArea").hide();
					// 전체 영역 숨김처리
					$("div.formContainer").hide();
					// 번호이동2 영역 표시
					$("div.formContainer[dispView='phoneMove02']").show();
				} else if("T" == bfacAgreeYn) {
					// 사전동의 성공처리
					controller.isBfacAgree = true;
					// 다음버튼 영역 숨김
					$("#nextStepBtnArea").hide();
					// 전체 영역 숨김처리
					$("div.formContainer").hide();
					// 번호이동2 영역 표시
					$("div.formContainer[dispView='phoneMove02']").show();
					// ARS에 동의 및 조회 하는곳을 조회만으로 변경
					$("#npCmpnArsChkBtn").attr("onclick", "fnChkPhoneMoveSelf('T')");
				}
			}
		});
	}
}

/** @번호이동_사전동의_확인 */
function fnChkPhoneMoveSelf(type) {
	if(!controller.isBfacAgree) {
		alert("번호이동 사전체크를 완료해 주세요.");
		return;
	}

	// 이미 사전동의 결과 성공 했으면 화면 이동만
	if(controller.isBfacAgreeRpyRetv && controller.isMakeCust) {
		// 번호이동(납부방법으로 이동 처리)
		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 납부 영역 표시
		$("div.formContainer[dispView='view04']").show();
		// 숨겨놨던 다음 버튼 노출
		$("#nextStepBtnArea").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(4)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(4)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(4)").attr("aria-current", "step");
		return;
	}

	// 창 열기
	togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');

	// 로딩문구때문에, 따로 실행
	if($("#loading").length == 0) {
		$("body").prepend('<div id="loading"><div class="iconLoading"></div><p>번호 이동 처리는 최대 2분까지 소요될 수 있습니다.</p></div>');
	}

	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	// 연동 결과 확인
	var varData = controller.getSerializedDataAllRSA({
		slsCmpnCd : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgreeRpyRetv.json"
		,data:varData
		,dataType:"json"
		,isBlock:false
		,successCall:function(result){
			var npRpyRetvYn = result.npRpyRetvYn;
			// 사전동의 성공
			if("Y" == npRpyRetvYn) {
				// 사전동의 결과 성공처리
				controller.isBfacAgreeRpyRetv = true;

				// 명세서 전화번호
				var npTlphNo = $("#npTlphNo").val();
				$("#rqsshtTlphNo").val(npTlphNo);

				// 번호이동 고객생성 START
				fnChkSelfMakeCustInfo(false, type);
			} else if("N" == npRpyRetvYn) {
				//alert("번호이동 사전동의 응답이 아직 수신되지 않았습니다. 잠시후 재시도하시기 바랍니다.");

				if("N" == npRpyRetvYn) {
					if(type == 'T') {
						togglePopup('npCmpnArsChkBtn', 'popupMoveFail02'); // ARS 팝업 ( 수정 )
					} else {
						togglePopup('npCmpnMsgPopBtn', 'popupMoveFail01'); // 문자 팝업 ( 수정 )
					}
				}

				// 창 닫기
				togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				// 로딩바 제거
				loadUnBlock();
			} else {
				// 창 닫기
				togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				// 로딩바 제거
				loadUnBlock();
			}
		},errorCall:function() {
			// 창 닫기
			if($("#phoneMoveProcIngPop.show").length > 0) {
				togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
			}
			// 로딩바 제거
			loadUnBlock();
		}
	});
}

/** @번호이동_사전동의_요청_확인_ARS팝업 */
function fnChkPhoneMoveSelf2() {
	// 이미 사전동의 결과 성공 했으면 화면 이동만
	if(controller.isBfacAgreeRpyRetv && controller.isMakeCust) {
		// 번호이동(납부방법으로 이동 처리)
		// 전체 영역 숨김처리
		$("div.formContainer").hide();
		// 납부 영역 표시
		$("div.formContainer[dispView='view04']").show();
		// 숨겨놨던 다음 버튼 노출
		$("#nextStepBtnArea").show();
		// 스텝 이동
		$("div.applySteps > ul > li").removeClass("current");
		$("div.applySteps > ul > li:eq(4)").addClass("current");
		// 셀프개통 타이틀 변경
		changeTitle();
		// 현재 단계 이동
		var htmlString = "<span class='message'>현재 단계</span>";
		$("div.applySteps > ul > li > span").remove();
		$("div.applySteps > ul > li:eq(4)").prepend(htmlString);
		$("div.applySteps > ul > li").attr("aria-current", null);
		$("div.applySteps > ul > li:eq(4)").attr("aria-current", "step");
		return;
	}

	// 창 열기
	togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');

	// 로딩문구때문에, 따로 실행
	if($("#loading").length == 0) {
		$("body").prepend('<div id="loading"><div class="iconLoading"></div><p>번호 이동 처리는 최대 2분까지 소요될 수 있습니다.</p></div>');
	}

	var isAgreeRpyRetv = false;
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	var varData = controller.getSerializedDataAllRSA({
		slsCmpnCd : $("#saleCmpnId").val()
		, npTlphNo : $("#npTlphNo").val()
		, bchngNpCommCmpnCd : $("#bchngNpCommCmpnCd").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgree.json"
		,data:varData
		,dataType:"json"
		,isBlock:false
		,async:false
		,successCall:function(result){
			var bfacAgreeYn = result.bfacAgreeYn;
			// 사전동의 성공
			if("Y" == bfacAgreeYn) {
				isAgreeRpyRetv = true;
			}
		}
	});

	if(isAgreeRpyRetv) {
		// 연동 결과 확인
		var varData = controller.getSerializedDataAllRSA({
			slsCmpnCd : $("#saleCmpnId").val()
			, oderTypeCd : oderTypeCd
		});

		controller.ajaxSend({
			cache:false
			,url:svcRouteURL + "/fe/service/usim/phoneMoveBfacAgreeRpyRetv.json"
			,data:varData
			,dataType:"json"
			,isBlock:false
			,successCall:function(result){
				var npRpyRetvYn = result.npRpyRetvYn;
				// 사전동의 성공
				if("Y" == npRpyRetvYn) {
					// 사전동의 결과 성공처리
					controller.isBfacAgreeRpyRetv = true;

					// 명세서 전화번호
					var npTlphNo = $("#npTlphNo").val();
					$("#rqsshtTlphNo").val(npTlphNo);

					// 번호이동 고객생성 START
					fnChkSelfMakeCustInfo(false, 'T');
				} else if("N" == npRpyRetvYn) {
					alert("번호이동 사전동의 응답이 아직 수신되지 않았습니다. 잠시후 재시도하시기 바랍니다.");

					togglePopup('npCmpnArsChkBtn', 'popupMoveFail02');

					// 창 닫기
					if($("#phoneMoveProcIngPop.show").length > 0) {
						togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
					}
					// 로딩바 제거
					loadUnBlock();
					// F가 실패, N은 사전동의 요청 진행 중...요청중이면, 다시 사전동의 요청을 호출 할 필요가 없으므로 결과조회 함수로 변경
					$("#npCmpnArsChkBtn").attr("onclick", "fnChkPhoneMoveSelf('T')");
				} else { //추가
					if($("#phoneMoveProcIngPop.show").length > 0) {
						togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
					}

					// 로딩바 제거
					loadUnBlock();
				}
			},errorCall:function() {
				// 창 닫기
				if($("#phoneMoveProcIngPop.show").length > 0) {
					togglePopup('phoneMoveProcIngBtn', 'phoneMoveProcIngPop');
				}
				// 로딩바 제거
				loadUnBlock();
			}
		});
	}
}

/** @번호이동_사전체크_실패 확인버튼 클릭 */
function fnPhoneMoveFail() {
	// 셀프주문 메인 이동
	location.href = svcRouteURL + "/fe/service/usim/usimSelfMain.do";
}

/** @납부방법_카드_유효성체크 */
function fnCardVaild() {
	controller.payValid = false;

	var cardCd = $("#cardCd").val();
	if("" == cardCd) {
		alert("납부하실 카드를 선택해 주세요.");
		$(":button[name='cardBtn']:eq(0)").focus();
		return;
	}
	var blpymMthdIdntNoCard = $("#blpymMthdIdntNoCard").val().replace(/\s/gi, "");
	if("" == blpymMthdIdntNoCard) {
		alert("납부하실 카드번호를 입력해 주세요.");
		$("#blpymMthdIdntNoCardTemp").focus();
		return;
	}
	var cardEffectMonth = $("#cardEffectMonth").val();
	if("" == cardEffectMonth) {
		alert("납부하실 카드 유효월을 선택해 주세요.");
		$(":button[name='cardMonthBtn']:eq(0)").focus();
		return;
	}
	var cardEffectYear = $("#cardEffectYear").val();
	if("" == cardEffectYear) {
		alert("납부하실 카드 유효년도를 선택해 주세요.");
		$(":button[name='cardYearBtn']:eq(0)").focus();
		return;
	}
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	var varData = controller.getSerializedDataAllRSA({
		crdtCardNo : blpymMthdIdntNoCard
		, crdtCardTermDay : cardEffectYear+cardEffectMonth
		, crdtCardKindCd : cardCd
		, saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/vaildCreditCardInfo.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			var validBean = result.validBean;
			if("Y" == validBean.psblYn) {
				// 유효성검사 완료
				controller.payValid = true;
				$("#commonAlertPopupTitle").text("신용/체크카드 유효성 체크");
				$("#commonAlertPopupContent").text("신용/체크카드 인증이 완료 되었습니다.");
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')

				// 기존 버튼 숨기기
				$("#blpymMthdCardBtn").hide();
				// 인증완료 버튼 노출
				$("#blpymMthdCardCompBtn").show();
				// 납부방법 변경 불가 처리
				$(":radio[name='blpymMthdCd']").prop("disabled", true);

				//신용카드사 비활성화
				$("#selectCardBtn").prop("disabled", true);
				//신용카드 선택 불가
				$("#blpymMthdIdntNoCardTemp").prop("disabled", true);
				//월 일 비활성화
				$("#selectCardMonthBtn").prop("disabled", true);
				$("#selectCardYearBtn").prop("disabled", true);

			} else {
				$("#commonAlertPopupTitle").text("신용/체크카드 유효성 체크");
				$("#commonAlertPopupContent").text(validBean.rsltMsg);
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')
			}
		}
	});
}

/** @납부방법_자동이체_유효성체크 */
function fnBankVaild() {
	controller.payValid = false;

	var bankCd = $("#bankCd").val();
	if("" == bankCd) {
		alert("납부하실 은행을 선택해 주세요.");
		$(":button[name='bankBtn']:eq(0)").focus();
		return;
	}
	var blpymCustNmBk = $("#blpymCustNmBk").val();
	if("" == blpymCustNmBk) {
		alert("납부하실 계좌번호의 예금주명을 입력해 주세요.");
		$("#blpymCustNmBk").focus();
		return;
	}
	var blpymMthdIdntNoBk = $("#blpymMthdIdntNoBk").val().replace(/\s/gi, "");
	if("" == blpymMthdIdntNoBk) {
		alert("납부하실 계좌번호를 입력해 주세요.");
		$("#blpymMthdIdntNoBkTemp").focus();
		return;
	}
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	var varData = controller.getSerializedDataAllRSA({
		blBankCode : bankCd
		, bankAcctNo : blpymMthdIdntNoBk
		, custNm : blpymCustNmBk
		, saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/vaildBankAcntInfo.json"
		,data:varData
		,dataType:"json"
		,isBlock:true
		,successCall:function(result){
			var validBean = result.validBean;
			if("Y" == validBean.psblYn) {
				// 유효성검사 완료
				controller.payValid = true;

				$("#commonAlertPopupTitle").text("자동이체 유효성 체크");
				$("#commonAlertPopupContent").text("계좌번호 인증이 완료 되었습니다.");
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')

				// 기존 버튼 숨기기
				$("#blpymMthdBankBtn").hide();
				// 인증완료 버튼 노출
				$("#blpymMthdBankCompBtn").show();
				// 납부방법 변경 불가 처리
				$(":radio[name='blpymMthdCd']").prop("disabled", true);

				//계좌번호
				$("#blpymMthdIdntNoBkTemp").prop("disabled", true);

				//은행 선택 비활성화
				$("#selectBankBtn").prop("disabled", true);
				//이름 비활성화 //다시한번?
				$("#blpymCustNmBk").prop("disabled", true);

			} else {
				$("#commonAlertPopupTitle").text("신용/체크카드 유효성 체크");
				$("#commonAlertPopupContent").text(validBean.rsltMsg);
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')
			}
		}
	});
}

/** @개통처리 */
function fnUsimOpenProcess() {
	// 약관동의 여부 체크
	if(false == chkStpltValid()) {
		return;
	}
	if($('#prodTypeCd').val() !== 'W'){
		// 청구서양식코드
		var rqsshtPprfrmCd = $(":radio[name='rqsshtPprfrmCd']:checked").val() || '';
		// 청구서 이메일주소명
		var rqsshtEmlAdrsNm = $("#rqsshtEmlAdrsNm").val() || '';
		// 청구서전화번호는 신규의 경우 신규번호, 번호이동의 경우 번호이동할 번호로 진행
	}
	if($('#prodTypeCd').val() == 'W'){
		// 청구서양식코드
		var rqsshtPprfrmCd = "";
		// 청구서 이메일주소명
		var rqsshtEmlAdrsNm = "";
		// 청구서전화번호는 신규의 경우 신규번호, 번호이동의 경우 번호이동할 번호로 진행
	}
	// 약관
	var agreeChkCds = new Array();
	var sb = new Array();
	$(":checkbox[id^='stpltChk']:checked").each(function() {
		sb.push($(this).val());
	});
	agreeChkCds = sb.join('|');

	// 가입유형
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	// 2023.03.22 긴급배포건 신규가입 불가능 처리
	// 2023.05.09 주석 처리
	//oderTypeCdCheck(oderTypeCd);

	// 신분증 종류
	var rsdcrtIssuDate = "";
	var nativeRlnamAthnEvdnPprCd = "";
	var lcnsRgnCd = "";
	var lcnsNo = "";
	var mrtrPrsnNo = "";
	var chkCardTypeId = $(":radio[name='idCardType']:checked").attr("id");
	if("idCardType01" == chkCardTypeId) {
		rsdcrtIssuDate = $("#rssnoRegDate").val().replace(/\./g,"");
		nativeRlnamAthnEvdnPprCd = "REGID";
	} else if("idCardType02" == chkCardTypeId) {
		rsdcrtIssuDate = $("#lcnsRegDate").val().replace(/\./g,"");
		lcnsRgnCd = $("#lcnsRgnCd").val();
		lcnsNo = $("#lcnsNo").val();
		nativeRlnamAthnEvdnPprCd = "DRIVE";
	} else if("idCardType03" == chkCardTypeId) {
		rsdcrtIssuDate = $("#dsbPrsnRegDate").val().replace(/\./g,"");
		nativeRlnamAthnEvdnPprCd = "HANDI";
	} else if("idCardType04" == chkCardTypeId) {
		rsdcrtIssuDate = $("#mrtrPrsnDate").val().replace(/\./g,"");
		mrtrPrsnNo = $("#mrtrPrsnNo").val();
		nativeRlnamAthnEvdnPprCd = "MERIT";
	}

	// 셀프개통처리중 팝업 노출
	togglePopup('selfOpenIngBtn', 'selfOpenIngPop');

	// 로딩바 생성
	if($("#loading").length == 0) {
		$("body").prepend('<div id="loading"><div class="iconLoading"></div><p>셀프 개통 처리중입니다.</p></div>');
	}


	var varData = controller.getSerializedDataAllRSA({
		rqsshtPprfrmCd : rqsshtPprfrmCd
		, rqsshtEmlAdrsNm : rqsshtEmlAdrsNm
		, zipCd : $("#zipCd").val()
		, billFndtCntplcSbst : $("#custAddr").val()
		, billMntCntplcSbst : $("#custAddrDtl").val()
		, prdcCd : $("#pplId").val()
		, saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
		, bchngNpCommCmpnCd : $("#bchngNpCommCmpnCd").val()
		, npAthnCd : $("#npAthnCd").val()
		, npTlphNo : $("#npTlphNo").val()
		, npPhoneSrilNum : $("#npPhoneSrilNum").val()
		, npBlpymMthdBankNo : $("#npBlpymMthdBankNo").val()
		, npBlpymMthdCardNo : $("#npBlpymMthdCardNo").val()
		, sbscPrtlstRcvEmlAdrsNm : $("#custMail").val()
		, agreeChkCds : agreeChkCds
		, idCardType : nativeRlnamAthnEvdnPprCd
		, idCardRegDate : rsdcrtIssuDate
		, lcnsRgnCd : lcnsRgnCd
		, lcnsNo : lcnsNo
		, mrtrPrsnNo : mrtrPrsnNo
		, basChage : $("#basChage").val()
		, promDc : $("#promDc").val()
		, monthCommChage : $("#monthCommChage").val()
		, monthPayAmt : $("#monthPayAmt").val()
		, custPhoneNo : $("#custPhoneNo").val()
		, prodTypeCd : $('#prodTypeCd').val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/usimOpenProcReq.json"
		,data:varData
		,dataType:"json"
		,isBlock:false
		,successCall:function(result){
			// 처리 중 팝업 닫기
			togglePopup('selfOpenIngBtn', 'selfOpenIngPop');

			var openProcCd = result.openProcCd;
			if("S" == openProcCd) {
				pushEventTagging("","");
				// 완료 팝업 호출
				togglePopup('selfOpenSuccBtn', 'selfOpenSuccPop');
			} else {
				$("#commonAlertPopupTitle").text("개통신청");
				$("#commonAlertPopupContent").text("셀프개통이 정상적으로 진행되지 않습니다. 다음에 다시 시도해 주세요.");
				togglePopup('commonAlertPopupBtn', 'commonAlertPopup')
			}
			loadUnBlock();
		}
		,errorCall:function() {
			loadUnBlock();
			// 처리 중 팝업 닫기
			togglePopup('selfOpenIngBtn', 'selfOpenIngPop');

			// 실패 팝업 열기
			togglePopup('selfOpenFailBtn', 'selfOpenFailPop');
		}
	});
}

/** @약관체크 */
function chkStpltValid() {
	var stpltLen = $(":checkbox[id^='stpltChk']").length;
	for(var i=0; i<stpltLen; i++) {
		if(false == $(":checkbox[id^='stpltChk']").eq(i).is(":checked") && "Y" == $(":checkbox[id^='stpltChk']").eq(i).attr("mustYn")) {
			alert($(":checkbox[id^='stpltChk']").eq(i).attr("stpltNm")+"약관에 동의하여 주시기 바랍니다.");
			$(":checkbox[id^='stpltChk']").eq(i).focus();
			return false;
		}
	}
	if(false == $(":checkbox[id='selfOpenStplt']").is(":checked")) {
		alert("셀프개통 안내사항 약관에 동의하여 주시기 바랍니다.");
		$(":checkbox[id='selfOpenStplt']").focus();
		return false;
	}
	return true;
}


/** @가입유형_가능한유형처리 */
function fnSbscTypeCdPoss() {
	var selfPossCd = $("#selfPossCd").val();
	if("N" == selfPossCd) {
		$(":radio[name='oderTypeCd']").prop("disabled", true);
		//$(":radio[name='oderTypeCd']").parents(".checkboxLine").hide();
	} else if("A" == selfPossCd) {
		$(":radio[id='oderTypeCd02']").prop("disabled", true);
	} else if("B" == selfPossCd) {
		$(":radio[id='oderTypeCd01']").prop("disabled", true);
	} else if("C" == selfPossCd) {
		$(":radio[id='oderTypeCd02']").prop("disabled", true);
		// 번호이동 선택 숨김
		$(":radio[id='oderTypeCd02']").parents(".checkboxLine").hide();
		$(":radio[id='oderTypeCd02']").parents(".checkboxLine").parents("#checkboxDiv").attr("class", "dataInner");
	} else if("D" == selfPossCd) {
		$(":radio[id='oderTypeCd01']").prop("disabled", true);
		// 신규가입 선택 숨김
		$(":radio[id='oderTypeCd01']").parents(".checkboxLine").hide();
		$(":radio[id='oderTypeCd01']").parents(".checkboxLine").parents("#checkboxDiv").attr("class", "dataInner");
	}
}

/** @캡챠_이미지조회 */
function getImage() {
	var cryptoObj = window.crypto || window.msCrypto; // for IE 11
	var array = new Uint32Array(1);
	var rand = cryptoObj.getRandomValues(array);
	var url = routeURL + '/fe/mypage/captcha/captchaImg.do?rand='+rand;
	document.querySelector('#captchaImg').setAttribute('src', url);
	$("#answer").val("");
}

/** @캡챠_오디오듣기 */
function audio_new() {
	var cryptoObj = window.crypto || window.msCrypto; // for IE 11

	var array = new Uint32Array(1);
	var rand = cryptoObj.getRandomValues(array);
	var uAgent = navigator.userAgent;
	var soundUrl = routeURL + '/fe/mypage/captcha/captchaAudio.do?rand='+rand;

	if (uAgent.indexOf('Trident') > -1 || uAgent.indexOf('MSIE') > -1 || window.ActiveXobject) {

		if (uAgent.indexOf("MSIE 8") > -1) {
			var htmlString = "<object type='audio/x-wav' width='0' height='0'>"
					+ "<param name='src' value='" + soundUrl + "'/>"
					+ "<param name='autostart' value='true' />"
					+ "<param name='controller' value='false' />"
					+ "</object>";
			$("#ccaudio").empty();
			$("#ccaudio").append(htmlString);
		} else {
			window.open(soundUrl,'','width=1,height=1');
		}
	} else {
		var a = document.createElement("audio");
		if (a.canPlayType && a.canPlayType("audio/wav") && !(uAgent.indexOf('Safari') > -1 && uAgent.indexOf('Chrome') < 0)) {
	//			<%-- html5 audio wav 지원되는 경우, 사파리는 세션ID가 전달되지 않아 사용불가하므로 미지원 alert 노출 --%>
			$("#ccaudio").html("<audio src='" + soundUrl + "' autoplay='true' />");
		} else {
			alert("보안문자 음성듣기가 지원되지 않는 브라우저입니다.");
		}
	}
}

function notSupportDeviceAlert(){
	alert("지원하지 않는 기능입니다. ");
}

/** @번호이동_ARS연결 */
function fnArsConn() {
	// MO
	if(isUserDevice()) {
		var arsCmpnPhoneNo = $("#arsCmpnPhoneNo").text().replace(/[^0-9]/gi, "");
		var sb = new Array();
		sb.push("tel:");
		sb.push(arsCmpnPhoneNo);
		document.location.href = sb.join("");
	}
	// PC
	else {
		alert("PC에서는 지원하지 않는 기능 입니다.");
	}
}

/** @단말목록 조회 */
function searchModelList(){

	if("" == $("#saleCmpnId").val()) {
		alert("알뜰폰 사업자를 선택해 주세요.");
		$("#bizSelBtn").focus();
		return;
	}

	if("" == $("#modelNm").val()) {
		alert("모델명을 입력하여 주세요.");
		$("#modelSearch").focus();
		return;
	}

	if($("#modelNm").val().length < 3) {
		alert("모델명 3자리 이상으로 입력하여 주세요.");
		$("#modelSearch").focus();
		return;
	}

	var varData = controller.getSerializedData({
		saleCmpnId : $("#saleCmpnId").val()
		, modelListCnt : $("#modelListCnt").val()
		, modelListPageNo : $("#modelSearchPageNo").val()
		, modelNm : $("#modelNm").val()
		, netDivCd : $("#netDivCd").val()
	});

	controller.ajaxSendDone({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/getModelList.thym"
		,data:varData
		,isBlock:true
		,replaceAttr:"#popupModelDevice"
		,successCall:function(result){
			//console.log(result)
		}
		,replaceAttrCall: function(){
			drawModelListResult();
		}
	});
}

/** @단말등록 조회 다음 페이지 이동 */
function nextModelListPage(){
	var pageNo = parseInt($("#modelSearchPageNo").val());
	pageNo++;
	$("#modelSearchPageNo").val(pageNo);

	searchModelList();
}

/** @단말등록 조회 이전 페이지 이동 */
function previousModelListPage(){
	var pageNo = parseInt($("#modelSearchPageNo").val());
	if(pageNo > 1){
		pageNo--;
	}
	$("#modelSearchPageNo").val(pageNo);

	searchModelList();
}

/** @단말등록 조회 결과 생성 */
function drawModelListResult(){
	$("#currentModelListPage").val($("#modelSearchPageNo").val());

	var pageNo = parseInt($("#modelSearchPageNo").val());

	if(pageNo == 1){
		$("#previousModelSearch").attr("disabled", "disabled");
	}else{
		$("#previousModelSearch").removeAttr("disabled");
	}
	if($("div.deviceContent li").length < $("#modelListCnt").val()){
		$("#nextModelSearch").attr("disabled", "disabled");
	}else{
		$("#nextModelSearch").removeAttr("disabled");
	}

	if($("#popupModelDevice").is(":hidden")){
		togglePopup('btnIDModelDevice', 'popupModelDevice');
	}

	$("#currentModelListPage span").html(pageNo);
}

/** @단말 모델 선택 */
function selectModel(){
	$("#intmMdlId").val($(":radio[name='modelNameGroup']:checked").attr("model-id"));
	$("#intmMdlNm").val($(":radio[name='modelNameGroup']:checked").val());
	//$("#modelNm").val($(":radio[name='modelNameGroup']:checked").val());
	//togglePopup('btnIDModelDevice', 'popupModelDevice');
}

/** @약관동의_셀프개통_안내사항_자동선택처리 */
function fnOpenStpltConfirm() {
	$("#selfOpenStplt").prop("checked", true);
	togglePopup('esimSelfOrdrInfoBtn', 'esimSelfOrdrInfo')
}

/** @esim 개통 화면 보여주기 */
function showEsimArea(){
	$(".esimArea").show();
	$("#omdRegArea").hide();
}

/** @esim 개통 화면 숨가기 */
function hideEsimArea(){
	$(".esimArea").hide();
}

/** @자급제 단말 등록 화면 보여주기 */
function showOmdRegArea(){
	$("#omdRegArea").show();
	$("#pleaseSelectGen, #modelNm, #modelSearch, #omdHndsetAdd").removeAttr("disabled");
	$("#pleaseSelectGen").focus();
}

/** @자급제 단말 등록 화면 비활성화 */
function deactiveOmdRegArea(){
	$("#pleaseSelectGen, #modelNm, #modelSearch, #omdHndsetAdd").attr("disabled", "disabled");
}

/** @셀프개통_사업자_자동선택 */
function saleCmnpnAutoChk() {
	loadBlock();
	var reqSaleCmpnId = $("#reqSaleCmpnId").val();
	var bizrSeq = "";

	var varData = controller.getSerializedData({
		prodTypeCd : $("#prodTypeCd").val()
	});

	controller.ajaxSend({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/listSelfPossBizrInfo.json"
		,dataType:"json"
		,data: varData
		,isBlock:false
		,async:false
		,successCall:function(result){
			var bizrList = result.bizrList;

			// 화면 그리기
			var sb = new Array();
			for(var i=0; i<bizrList.length; i++) {
				var bizr = bizrList[i];
				// 파람정보와 같은 대리점이 노출 시 선택 처리
				if(bizr.saleCmpnId == reqSaleCmpnId) {
					bizrSeq = bizr.bizrSeq;

					sb.push('<li>');
					sb.push('	<div class="checkboxLine">');
					sb.push('		<input type="radio" id="bizrSelRdo'+i+'" name="bizrSelRdo" value="'+bizr.bizrSeq+'" />');
					sb.push('		<label for="bizrSelRdo'+i+'" class="checkboxLabel">');
					sb.push('			<span>'+bizr.brndNm+'</span>');
					sb.push('			<span class="checkIcon"></span>');
					sb.push('		</label>');
					sb.push('	</div>');
					sb.push('</li>');
					break;
				}
			}
			// 사업자 화면 구성
			$("#bizrSelectViewUl").html(sb.join(''));
			// radio에 값 넣기
			for(var i=0; i<bizrList.length; i++) {
				// 파람정보와 같은 대리점만 정보 입력 처리
				if(bizrList[i].saleCmpnId == reqSaleCmpnId) {
					// 하나만 있을터이니 0번째
					$(":radio[name='bizrSelRdo']:eq(0)").data(bizrList[i]);
					break;
				}
			}

			if("" == bizrSeq) {
				// 선택된 사업자가 없으므로 끝냄
				loadUnBlock();
			} else {
				// 파라미터 사업자코드와 같은 정보 선택처리
				$(":radio[name='bizrSelRdo'][value='"+bizrSeq+"']").trigger("click");
				// 사업자 선택 후 처리
				bizrSelCmplt();
				loadUnBlock();
			}
		},errorCall:function() {
			loadUnBlock();
		}
	});
}

/** @셀프개통_요금제_자동선택 */
function pplInfoAutoChk() {
	if("" == $("#saleCmpnId").val()) {
		return;
	}

	var reqPplId = $("#reqPplId").val();

	var varData = controller.getSerializedData({
		comparePageYn : "Y"
		, paramSaleCmpnId : $("#saleCmpnId").val()
		, pplIds : reqPplId
		, selfPossCd : $("#selfPossCd").val()
	});

	controller.ajaxSendDone({
		cache:false
		,url:svcRouteURL + "/fe/service/usim/listSelfPossPplInfo.thym"
		,data:varData
		,isBlock:false
		,async:false
		,replaceAttr:"#pplSelectPopupContentsView"
		,successCall:function(result){
			setTimeout(function() {
				if($(":radio[name='pplListChk'][value='"+reqPplId+"']").length > 0) {
					// 파람요금제와 같은 요금제 선택 처리
					$(":radio[name='pplListChk'][value='"+reqPplId+"']").trigger("click");
					// 요금제 선택 후 처리
					pplSelCmplt();
				}else{
					togglePopup('pplSelBtn', 'popupAutoPplChkFail');
				}

				loadUnBlock();
			}, 200);
		},errorCall:function() {
			loadUnBlock();
		}
	});
}

/** @셀프개통_타이틀_변경 */
function changeTitle(){
	var dispView = $("div.formContainer:visible").attr("dispView");

	// 가입유형
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();

	if($("#prodTypeCd").val() == "W"){
		if("view01" == dispView) {
			$("title").text("1단계 요금제 선택 | 워치개통 신청 | 워치개통(eSIM) | 유심/eSIM | KT 마이알뜰폰");
		}else if("view02" == dispView) {
			$("title").text("2단계 본인확인·약관동의 | 워치개통 신청 | 워치개통(eSIM) | 유심/eSIM | KT 마이알뜰폰");
		}else if("view03" == dispView) {
			$("title").text("3단계 신분증 확인 | 워치개통 신청 | 워치개통(eSIM) | 유심/eSIM | KT 마이알뜰폰");
		}else if("newSelf01" == dispView) {
			$("title").text("4단계 번호 조회·선택 | 워치개통 신청 | 워치개통(eSIM) | 유심/eSIM | KT 마이알뜰폰");
		}
	}else{
		if("view01" == dispView) {
			$("title").text("1단계 신청 요금제·유형 선택 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("view02" == dispView) {
			$("title").text("2단계 본인확인·약관동의 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("view03" == dispView) {
			$("title").text("3단계 고객정보·신분증 확인 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("newSelf01" == dispView) {
			$("title").text("4단계 번호 조회·선택 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("phoneMove01" == dispView) {
			$("title").text("4단계 이동 전화번호 입력·인증 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("phoneMove02" == dispView) {
			$("title").text("5단계 번호이동 사전동의 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
		}else if("view04" == dispView) {
			if(oderTypeCd == "01"){ // 신규가입
				$("title").text("5단계 명세서·납부유형 선택 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
			}else if(oderTypeCd == "02"){ // 번호이동
				$("title").text("6단계 명세서·납부유형 선택 | 셀프개통 신청 | 셀프개통 | 유심/eSIM | KT 마이알뜰폰");
			}
		}
	}
}


function closeCommonAlertPopup(){
	togglePopup('commonAlertPopupBtn', 'commonAlertPopup');
	if($("#esimValidChk").is(":visible") == true){
		var disaledCheck = $("#esimValidChk").attr("disabled");
		if(disaledCheck != 'disabled'){
			$("#esimValidChk").focus();
		}else{
			$("#goNextStep").focus();
		}
	}
	if($("#watchValidChk").is(":visible") == true){
		var watchValidChkCheck = $("#watchValidChk").attr("disabled");
		if(watchValidChkCheck != 'disabled'){
			$("#watchValidChk").focus();
		}else{
			$("#watchSelfOpen").focus();
		}
	}
}

function fnPopupSmantWatchConfirm() {
	togglePopup('smantWatchConfirm', 'popupSmantWatchConfirm');
	$("#popupSmantWatchConfirm .popupContainer>.popupTop>.btnClose").on("click", function() {
		togglePopup('smantWatchConfirm', 'popupSmantWatchConfirm');
		$("#samsungAnchor1").attr("aria-selected","false");
		$("#appleAnchor1").attr("aria-selected","true");
		$("#samsungContent1").attr("class","tabContent");
		$("#appleContent1").attr("class","tabContent show");
	});
}

function fnPopupSmantWatch(input) {
	togglePopup('btnSmantWatch', 'popupSmantWatchConfirm');
	$("#popupSmantWatchConfirm .popupContainer>.popupTop>.btnClose").on("click", function() {
		togglePopup('btnSmantWatch', 'popupSmantWatchConfirm');
		$("#samsungAnchor1").attr("aria-selected","false");
		$("#appleAnchor1").attr("aria-selected","true");
		$("#samsungContent1").attr("class","tabContent");
		$("#appleContent1").attr("class","tabContent show");
	});
}

function fnPopupWatchCellularClose() {
	togglePopup('pairingEsimAbout', 'popupWatchCellular');
	$("#samsungAnchor02").attr("aria-selected","false");
	$("#appleAnchor02").attr("aria-selected","true");
	$("#samsungContent02").attr("class","tabContent");
	$("#appleContent02").attr("class","tabContent show");
}

/** 2023.03.22 긴급배포건 신규가입 불가능 처리 */
/** 2023.05.09 주석 처리 */
//function oderTypeCdCheck(input) {
//	if($('#prodTypeCd').val() !== 'W') {
//		if("02" != input) {
//			alert("현재 번호이동 서비스만 이용 가능합니다.");
//			location.href = "/fe/service/usim/usimSelfReqView.do";
//		}
//	}
//}

/** @기업은행팝업_호출 */
function callIbkPopup() {
	// 팝업 호출
	togglePopup('btnPopupIndustrialBank', 'popupIndustrialBank');
}

function closeEIDIMEIConfirmToIMGPopupView(){
	togglePopup('EIDIMEIConfirmToIMGPopupBtn', 'EIDIMEIConfirmToIMGPopupView');
	$("#EIDIMEIConfirmToIMGPopupBtn").focus();
}

/** @가입조건체크 */
function fnChkSbscPosblCondYn(oderTypeCd){
	var chkSbscPosblCondYnFlag = false;
	var chkData = controller.getSerializedData({
		saleCmpnId : $("#saleCmpnId").val()
		, oderTypeCd : oderTypeCd
		, pplId : $("#pplId").val()
	});
	controller.ajaxSend({
		cache:false
		,async: false
		,url:svcRouteURL + "/fe/service/usim/chkSbscPosblCondYn.json"
		,data:chkData
		,isBlock:true
		,successCall:function(data){
			if(data.result == "true"){
				chkSbscPosblCondYnFlag = true;
			}else{
				chkSbscPosblCondYnFlag = false;
			}
		}
	});
	return chkSbscPosblCondYnFlag;
}

/**=============GA4 통계 소스 시작=============**/
$(document).on("click", "a[dynamicParamAttr1='바로배송유심 바로가기']"
		+ ",button[dynamicParamAttr1='알뜰폰 사업자 선택하기'],button[dynamicParamAttr1='요금제 선택하기']"
		+ ",button[dynamicParamAttr1='사업자 다시 선택하기'],button[dynamicParamAttr1='요금제 다시 선택하기']"
		+ ",button[dynamicParamAttr1='PASS 인증'],button[dynamicParamAttr1='신용카드 인증']"
		+ ",button[dynamicParamAttr1='번호 조회'],button[dynamicParamAttr1='번호 취소']"
		+ ",button[dynamicParamAttr1='사전체크 확인']"
		+ ",button[dynamicParamAttr1='ARS 번호 확인']"
		+ ",button[dynamicParamAttr1='셀프개통 신청'],button[dynamicParamAttr1='번호이동 신청']"
		, function () {
	var dynamicParam1 = "";
	var dispView = $("div.formContainer:visible").attr("dispView");
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	if("view01" == dispView) {
		dynamicParam1 = "self_step_1";
	} else if("view02" == dispView) {
		dynamicParam1 = "self_step_2";
	} else if("view03" == dispView) {
		dynamicParam1 = "self_step_3";
	} else if("newSelf01" == dispView || "phoneMove01" == dispView) {
		dynamicParam1 = "self_step_4";
	} else if("view04" == dispView || "phoneMove02" == dispView) {
		dynamicParam1 = (oderTypeCd == "01" && "view04" == dispView) ? "self_step_5" : ((oderTypeCd == "02" && "view04" == dispView) ? "self_step_6" : "self_step_5");
	}

	var dynamicParam2 = "view01" == dispView ? "공통" : (("view01" != dispView && oderTypeCd == "01") ? "신규가입" : "번호이동");
	var dynamicParam3 = $(this).attr("dynamicParamAttr1");
	var dynamicParam4 = "";
	var eventName = "";

	push_dataLayer_data(dynamicParam1,dynamicParam2,dynamicParam3,dynamicParam4,eventName);
});

function pushEventTagging(dispView, param) {
	var oderTypeCd = $(":radio[name='oderTypeCd']:checked").val();
	var dynamicParam1 = "";
	var dynamicParam2 = "";
	var dynamicParam3 = "";
	var dynamicParam4 = "";
	var eventName = "";

	if(dispView == "" && param == "") {
		dynamicParam1 = oderTypeCd == "01" ? "신규가입" : "번호이동";
		dynamicParam2 = "";
		eventName = "self_complete";
	} else {
		if("view01" == dispView) {
			dynamicParam1 = "self_step_1";
		} else if("view02" == dispView) {
			dynamicParam1 = "self_step_2";
		} else if("view03" == dispView) {
			dynamicParam1 = "self_step_3";
		} else if("newSelf01" == dispView || "phoneMove01" == dispView) {
			dynamicParam1 = "self_step_4";
		} else if("view04" == dispView || "phoneMove02" == dispView) {
			dynamicParam1 = (oderTypeCd == "01" && "view04" == dispView) ? "self_step_5" : ((oderTypeCd == "02" && "view04" == dispView) ? "self_step_6" : "self_step_5");
		}
		dynamicParam2 = "view01" == dispView ? "공통" : (("view01" != dispView && oderTypeCd == "01") ? "신규가입" : "번호이동");
		dynamicParam3 = param;
	}

	push_dataLayer_data(dynamicParam1,dynamicParam2,dynamicParam3,dynamicParam4,eventName);
}
/**=============GA4 통계 소스 종료=============**/
